<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.450">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Regession analysis report</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="regression_transparency_files/libs/clipboard/clipboard.min.js"></script>
<script src="regression_transparency_files/libs/quarto-html/quarto.js"></script>
<script src="regression_transparency_files/libs/quarto-html/popper.min.js"></script>
<script src="regression_transparency_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="regression_transparency_files/libs/quarto-html/anchor.min.js"></script>
<link href="regression_transparency_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="regression_transparency_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="regression_transparency_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="regression_transparency_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="regression_transparency_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">

  <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

</head>

<body>

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">
<div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
  <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#joint-groups-t-maj-t-min-vs-c-maj-c-min" id="toc-joint-groups-t-maj-t-min-vs-c-maj-c-min" class="nav-link active" data-scroll-target="#joint-groups-t-maj-t-min-vs-c-maj-c-min"><span class="header-section-number">1</span> Joint groups (T-Maj + T-Min vs C-Maj + C-Min)</a>
  <ul class="collapse">
  <li><a href="#event-study-design-unsaturated-model" id="toc-event-study-design-unsaturated-model" class="nav-link" data-scroll-target="#event-study-design-unsaturated-model"><span class="header-section-number">1.1</span> Event Study design (unsaturated model)</a></li>
  <li><a href="#event-study-design-with-fixed-effects" id="toc-event-study-design-with-fixed-effects" class="nav-link" data-scroll-target="#event-study-design-with-fixed-effects"><span class="header-section-number">1.2</span> Event Study design (with fixed effects)</a></li>
  <li><a href="#event-study-design-assets-weighted-unsaturated-model" id="toc-event-study-design-assets-weighted-unsaturated-model" class="nav-link" data-scroll-target="#event-study-design-assets-weighted-unsaturated-model"><span class="header-section-number">1.3</span> Event Study design assets weighted (unsaturated model)</a></li>
  <li><a href="#event-study-design-assets-weighted-with-fixed-effects" id="toc-event-study-design-assets-weighted-with-fixed-effects" class="nav-link" data-scroll-target="#event-study-design-assets-weighted-with-fixed-effects"><span class="header-section-number">1.4</span> Event Study design assets weighted (with fixed effects)</a></li>
  <li><a href="#diff-in-diff-design-unsaturated-model" id="toc-diff-in-diff-design-unsaturated-model" class="nav-link" data-scroll-target="#diff-in-diff-design-unsaturated-model"><span class="header-section-number">1.5</span> Diff-in-diff design (unsaturated model)</a></li>
  <li><a href="#diff-in-diff-design-with-fixed-effects" id="toc-diff-in-diff-design-with-fixed-effects" class="nav-link" data-scroll-target="#diff-in-diff-design-with-fixed-effects"><span class="header-section-number">1.6</span> Diff-in-diff design (with fixed effects)</a></li>
  <li><a href="#diff-in-diff-design-assets-weighted-unsaturated-model" id="toc-diff-in-diff-design-assets-weighted-unsaturated-model" class="nav-link" data-scroll-target="#diff-in-diff-design-assets-weighted-unsaturated-model"><span class="header-section-number">1.7</span> Diff-in-diff design assets weighted (unsaturated model)</a></li>
  <li><a href="#diff-in-diff-design-assets-weighted-with-fixed-effects" id="toc-diff-in-diff-design-assets-weighted-with-fixed-effects" class="nav-link" data-scroll-target="#diff-in-diff-design-assets-weighted-with-fixed-effects"><span class="header-section-number">1.8</span> Diff-in-diff design assets weighted (with fixed effects)</a></li>
  </ul></li>
  <li><a href="#major-groups-t-maj-vs-c-maj" id="toc-major-groups-t-maj-vs-c-maj" class="nav-link" data-scroll-target="#major-groups-t-maj-vs-c-maj"><span class="header-section-number">2</span> Major groups (T-Maj vs C-Maj)</a>
  <ul class="collapse">
  <li><a href="#event-study-design-unsaturated-model-1" id="toc-event-study-design-unsaturated-model-1" class="nav-link" data-scroll-target="#event-study-design-unsaturated-model-1"><span class="header-section-number">2.1</span> Event Study design (unsaturated model)</a></li>
  <li><a href="#event-study-design-with-fixed-effects-1" id="toc-event-study-design-with-fixed-effects-1" class="nav-link" data-scroll-target="#event-study-design-with-fixed-effects-1"><span class="header-section-number">2.2</span> Event Study design (with fixed effects)</a></li>
  <li><a href="#event-study-design-assets-weighted-unsaturated-model-1" id="toc-event-study-design-assets-weighted-unsaturated-model-1" class="nav-link" data-scroll-target="#event-study-design-assets-weighted-unsaturated-model-1"><span class="header-section-number">2.3</span> Event Study design assets weighted (unsaturated model)</a></li>
  <li><a href="#event-study-design-assets-weighted-with-fixed-effects-1" id="toc-event-study-design-assets-weighted-with-fixed-effects-1" class="nav-link" data-scroll-target="#event-study-design-assets-weighted-with-fixed-effects-1"><span class="header-section-number">2.4</span> Event Study design assets weighted (with fixed effects)</a></li>
  <li><a href="#diff-in-diff-design-unsaturated-model-1" id="toc-diff-in-diff-design-unsaturated-model-1" class="nav-link" data-scroll-target="#diff-in-diff-design-unsaturated-model-1"><span class="header-section-number">2.5</span> Diff-in-diff design (unsaturated model)</a></li>
  <li><a href="#diff-in-diff-design-with-fixed-effects-1" id="toc-diff-in-diff-design-with-fixed-effects-1" class="nav-link" data-scroll-target="#diff-in-diff-design-with-fixed-effects-1"><span class="header-section-number">2.6</span> Diff-in-diff design (with fixed effects)</a></li>
  <li><a href="#diff-in-diff-design-assets-weighted-unsaturated-model-1" id="toc-diff-in-diff-design-assets-weighted-unsaturated-model-1" class="nav-link" data-scroll-target="#diff-in-diff-design-assets-weighted-unsaturated-model-1"><span class="header-section-number">2.7</span> Diff-in-diff design assets weighted (unsaturated model)</a></li>
  <li><a href="#diff-in-diff-design-assets-weighted-with-fixed-effects-1" id="toc-diff-in-diff-design-assets-weighted-with-fixed-effects-1" class="nav-link" data-scroll-target="#diff-in-diff-design-assets-weighted-with-fixed-effects-1"><span class="header-section-number">2.8</span> Diff-in-diff design assets weighted (with fixed effects)</a></li>
  </ul></li>
  <li><a href="#minor-groups-t-min-vs-c-min" id="toc-minor-groups-t-min-vs-c-min" class="nav-link" data-scroll-target="#minor-groups-t-min-vs-c-min"><span class="header-section-number">3</span> Minor groups (T-Min vs C-Min)</a>
  <ul class="collapse">
  <li><a href="#event-study-design-unsaturated-model-2" id="toc-event-study-design-unsaturated-model-2" class="nav-link" data-scroll-target="#event-study-design-unsaturated-model-2"><span class="header-section-number">3.1</span> Event Study design (unsaturated model)</a></li>
  <li><a href="#event-study-design-with-fixed-effects-2" id="toc-event-study-design-with-fixed-effects-2" class="nav-link" data-scroll-target="#event-study-design-with-fixed-effects-2"><span class="header-section-number">3.2</span> Event Study design (with fixed effects)</a></li>
  <li><a href="#event-study-design-assets-weighted-unsaturated-model-2" id="toc-event-study-design-assets-weighted-unsaturated-model-2" class="nav-link" data-scroll-target="#event-study-design-assets-weighted-unsaturated-model-2"><span class="header-section-number">3.3</span> Event Study design assets weighted (unsaturated model)</a></li>
  <li><a href="#event-study-design-assets-weighted-with-fixed-effects-2" id="toc-event-study-design-assets-weighted-with-fixed-effects-2" class="nav-link" data-scroll-target="#event-study-design-assets-weighted-with-fixed-effects-2"><span class="header-section-number">3.4</span> Event Study design assets weighted (with fixed effects)</a></li>
  <li><a href="#diff-in-diff-design-unsaturated-model-2" id="toc-diff-in-diff-design-unsaturated-model-2" class="nav-link" data-scroll-target="#diff-in-diff-design-unsaturated-model-2"><span class="header-section-number">3.5</span> Diff-in-diff design (unsaturated model)</a></li>
  <li><a href="#diff-in-diff-design-with-fixed-effects-2" id="toc-diff-in-diff-design-with-fixed-effects-2" class="nav-link" data-scroll-target="#diff-in-diff-design-with-fixed-effects-2"><span class="header-section-number">3.6</span> Diff-in-diff design (with fixed effects)</a></li>
  <li><a href="#diff-in-diff-design-assets-weighted-unsaturated-model-2" id="toc-diff-in-diff-design-assets-weighted-unsaturated-model-2" class="nav-link" data-scroll-target="#diff-in-diff-design-assets-weighted-unsaturated-model-2"><span class="header-section-number">3.7</span> Diff-in-diff design assets weighted (unsaturated model)</a></li>
  <li><a href="#diff-in-diff-design-assets-weighted-with-fixed-effects-2" id="toc-diff-in-diff-design-assets-weighted-with-fixed-effects-2" class="nav-link" data-scroll-target="#diff-in-diff-design-assets-weighted-with-fixed-effects-2"><span class="header-section-number">3.8</span> Diff-in-diff design assets weighted (with fixed effects)</a></li>
  </ul></li>
  </ul>
</nav>
</div>
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Regession analysis report</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  

</header>

<p>Libraries:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(fixest)</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(broom)</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(scales)</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(here)</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="fu">source</span>(<span class="st">"global.R"</span>)</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a>populations <span class="ot">&lt;-</span> <span class="fu">str_split</span>(params<span class="sc">$</span>populations, <span class="at">pattern =</span> <span class="st">","</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">unlist</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="joint-groups-t-maj-t-min-vs-c-maj-c-min" class="level1" data-number="1">
<h1 data-number="1"><span class="header-section-number">1</span> Joint groups (T-Maj + T-Min vs C-Maj + C-Min)</h1>
<section id="event-study-design-unsaturated-model" class="level2" data-number="1.1">
<h2 data-number="1.1" class="anchored" data-anchor-id="event-study-design-unsaturated-model"><span class="header-section-number">1.1</span> Event Study design (unsaturated model)</h2>
<p><span class="math display">\[Y_{it} = \beta_0 + \beta_1 \times Treatment_{i} + \beta_2 \times Post_{t} + \sum_{k \neq 2014} \beta_k \times Time_{k} \times Treatment_{i} + \epsilon_{it}\]</span></p>
<p>Where:</p>
<ul>
<li><span class="math inline">\(\{ k = 2012, \ldots, 2017 \}\)</span></li>
<li><span class="math inline">\(Y_{it}\)</span> is Change from t-1 assets attributable to tax havens (positive), the dependent variable.</li>
<li><span class="math inline">\(Treatment_{i}\)</span> is a dummy variable that is 1 if unit <span class="math inline">\(i\)</span> receives the treatment at time <span class="math inline">\(t\)</span>, and 0 otherwise.</li>
<li><span class="math inline">\(Time_{i}\)</span> are dummy variables that are 1 if the year is <span class="math inline">\(k\)</span>, and 0 otherwise. The year 2014 is the reference year and therefore does not appear in the equation.</li>
<li><span class="math inline">\(\epsilon_{it}\)</span> is the error term.</li>
</ul>
<p><strong>Dependent variable:</strong> Change from t-1 assets attributable to tax havens (positive)</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-1-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-1" role="tab" aria-controls="tabset-1-1" aria-selected="true" href="">Plot</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-1-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-2" role="tab" aria-controls="tabset-1-2" aria-selected="false" href="">Regression table</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-1-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-3" role="tab" aria-controls="tabset-1-3" aria-selected="false" href="">R Code</a></li></ul>
<div class="tab-content">
<div id="tabset-1-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-1-1-tab">
<div class="cell">
<div class="cell-output-display">
<p><img src="regression_transparency_files/figure-html/unnamed-chunk-4-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</div>
<div id="tabset-1-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-1-2-tab">
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>
=====================================================================================================================================================
                                           All firms                           CIT &gt;= Statutory                    CIT &gt; 0                           
-----------------------------------------------------------------------------------------------------------------------------------------------------
(Intercept)                                                -6236828114807.77                  -17735460746679.97                  -12803900604513.22 
                                                           (5488212089033.73)                 (15576332794202.48)                 (11260808352126.99)
anio_fiscal                                                    3109960834.59                       8838298811.33                       6375911520.20 
                                                              (2736588471.68)                     (7762177656.26)                     (5607400119.10)
treatment                                                   1209111193657.68                    3004149532599.79                    1596241712267.97 
                                                           (1129829327657.00)                  (2989299469200.78)                  (1492619507879.01)
i(anio_fiscal, treatment, ref = 2014)2013                  -1126725100124.48                   -2991341561886.65                   -1476479776567.76 
                                                           (1127685625024.58)                  (2988592627601.89)                  (1490173467690.84)
i(anio_fiscal, treatment, ref = 2014)2015                   -193227372777.22                   -2961093510924.19                    -199186900697.45 
                                                            (157240443625.59)                  (2989641748637.45)                   (167166789309.53)
i(anio_fiscal, treatment, ref = 2014)2016                   -300490151858.16                   -1172101018087.39                    -184251011822.48 
                                                            (255405213555.55)                  (1233757842620.14)                   (161811947575.98)
i(anio_fiscal, treatment, ref = 2014)2017                   -237462150153.80                   -1391483035964.69                    -277966838709.77 
                                                            (180064287542.42)                  (1385541334529.29)                   (209070079836.75)
i(anio_fiscal, treatment, ref = 2014)2018                   -223602116457.79                   -1518761316293.61                    -185904093429.54 
                                                            (165870164201.28)                  (1493023439110.67)                   (144981995826.79)
i(anio_fiscal, treatment, ref = 2014)2019                   -147081837511.22                    -417900572140.30                      97016007381.05 
                                                            (102529734871.34)                   (518157709436.00)                   (255626783372.52)
-----------------------------------------------------------------------------------------------------------------------------------------------------
r.squared                                                               0.00                                0.00                                0.00 
adj.r.squared                                                           0.00                                0.00                                0.00 
sigma                                                       5558658419623.62                    8409890379393.84                    6744922766150.45 
statistic                                                               5.89                                4.42                                5.73 
p.value                                                                 0.00                                0.00                                0.00 
df                                                                      8                                   8                                   8    
logLik                                                            -742116.46                          -306395.15                          -506790.23 
AIC                                                               1484252.92                           612810.30                          1013600.46 
BIC                                                               1484333.83                           612882.23                          1013677.49 
deviance                                   745059953452404929442682022406      694390383307008607404848426620      744327057848155698880824046482    
df.residual                                                         24113                                9818                               16361    
nobs                                                                24122                                9827                               16370    
=====================================================================================================================================================
*** p &lt; 0.001; ** p &lt; 0.01; * p &lt; 0.05</code></pre>
</div>
</div>
</div>
<div id="tabset-1-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-1-3-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="co"># With this code we construct our formula as a string to use in the model function.</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Check above to see the label of the dependent variable.</span></span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>fml_event_study <span class="ot">&lt;-</span> glue<span class="sc">::</span><span class="fu">glue</span>(<span class="st">'{dependent} ~  anio_fiscal + treatment + i(anio_fiscal,treatment, ref = 2014)'</span>) <span class="sc">%&gt;%</span></span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">formula</span>(.)</span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Model estimation:</span></span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a>es_model <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="at">data =</span> rtable,</span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a>               <span class="at">formula =</span> fml_event_study)</span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-11"><a href="#cb3-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Wald test using clustered matrix of variance/covariance:</span></span>
<span id="cb3-12"><a href="#cb3-12" aria-hidden="true" tabindex="-1"></a>vcov_cl <span class="ot">&lt;-</span> <span class="fu">vcovCL</span>(<span class="at">x =</span> es_model,</span>
<span id="cb3-13"><a href="#cb3-13" aria-hidden="true" tabindex="-1"></a>                  <span class="at">cluster =</span> rtable<span class="sc">$</span>firm_id)</span>
<span id="cb3-14"><a href="#cb3-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-15"><a href="#cb3-15" aria-hidden="true" tabindex="-1"></a><span class="co"># Adjusted standard errors:</span></span>
<span id="cb3-16"><a href="#cb3-16" aria-hidden="true" tabindex="-1"></a>model_corrected <span class="ot">&lt;-</span> <span class="fu">coeftest</span>(<span class="at">vcov. =</span> vcov_cl,</span>
<span id="cb3-17"><a href="#cb3-17" aria-hidden="true" tabindex="-1"></a>                            <span class="at">x =</span> did_model_fe) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
</div>
</section>
<section id="event-study-design-with-fixed-effects" class="level2" data-number="1.2">
<h2 data-number="1.2" class="anchored" data-anchor-id="event-study-design-with-fixed-effects"><span class="header-section-number">1.2</span> Event Study design (with fixed effects)</h2>
<p><span class="math display">\[Y_{it} = \beta_0 + \beta_1 \times Treatment_{i} + \beta_2 \times Post_{t} + \sum_{k \neq 2014} \beta_k \times Time_{k} \times Treatment_{i} + \alpha_i + \gamma_t + \epsilon_{it}\]</span></p>
<p>Where:</p>
<ul>
<li><span class="math inline">\(\{ k = 2012, \ldots, 2017 \}\)</span></li>
<li><span class="math inline">\(Y_{it}\)</span> is Change from t-1 assets attributable to tax havens (positive), the dependent variable.</li>
<li><span class="math inline">\(Treatment_{i}\)</span> is a dummy variable that is 1 if unit <span class="math inline">\(i\)</span> receives the treatment at time <span class="math inline">\(t\)</span>, and 0 otherwise.</li>
<li><span class="math inline">\(Time_{i}\)</span> are dummy variables that are 1 if the year is <span class="math inline">\(k\)</span>, and 0 otherwise. The year 2014 is the reference year and therefore does not appear in the equation.</li>
<li><span class="math inline">\(alpha_i\)</span> are the fixed effects at firm level</li>
<li><span class="math inline">\(gamma_t\)</span> are the fixed effects at time</li>
<li><span class="math inline">\(\epsilon_{it}\)</span> is the error term.</li>
</ul>
<p><strong>Dependent variable:</strong> Change from t-1 assets attributable to tax havens (positive)</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-2-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-2-1" role="tab" aria-controls="tabset-2-1" aria-selected="true" href="">Plot</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-2-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-2-2" role="tab" aria-controls="tabset-2-2" aria-selected="false" href="">Regression table</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-2-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-2-3" role="tab" aria-controls="tabset-2-3" aria-selected="false" href="">R Code</a></li></ul>
<div class="tab-content">
<div id="tabset-2-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-2-1-tab">
<div class="cell">
<div class="cell-output-display">
<p><img src="regression_transparency_files/figure-html/unnamed-chunk-7-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</div>
<div id="tabset-2-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-2-2-tab">
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>
=====================================================================================================================================================
                                           All firms                           CIT &gt;= Statutory                    CIT &gt; 0                           
-----------------------------------------------------------------------------------------------------------------------------------------------------
anio_fiscal2014                                                5316005417.24                     189145671001.85                       9857080007.19 
                                                              (4782056781.83)                   (172484872379.98)                     (8947451730.43)
anio_fiscal2015                                               12892512457.48                      70881894292.87                      22191455749.14 
                                                             (11419003945.13)                    (64808045896.08)                    (19862677245.41)
anio_fiscal2016                                              202181753294.69                     722725404449.04                     345414480491.28 
                                                            (177261007928.15)                   (634675702811.45)                   (302969533323.16)
anio_fiscal2017                                               -7961609803.95                       9348217273.84                     -11836332391.98 
                                                              (6890455522.87)                    (13759742159.51)                    (10139717312.36)
anio_fiscal2018                                              -16135326719.53                     175859088253.72                     -26794442534.08 
                                                             (14042367126.85)                   (177737778072.67)                    (23055879627.04)
anio_fiscal2019                                              -20025248368.79                     162817743831.26                      42992400172.03 
                                                             (17440813069.95)                   (180904467723.47)                    (48931648681.43)
i(anio_fiscal, treatment, ref = 2014)2013                  -1234924963929.20                     -81051064306.61                   -1802263106376.61 
                                                           (1236328306805.54)                   (321792860011.49)                  (1804601373372.82)
i(anio_fiscal, treatment, ref = 2014)2015                   -176180713427.81                    -135042377970.47                    -275278561205.34 
                                                            (150186255736.97)                   (305710924348.50)                   (238088063210.74)
i(anio_fiscal, treatment, ref = 2014)2016                   -308143223100.20                    -958690953876.86                    -462283351838.74 
                                                            (196011202583.56)                   (651636618116.39)                   (312387498072.02)
i(anio_fiscal, treatment, ref = 2014)2017                    -22198126347.45                    -207895804187.96                     -48462334148.97 
                                                             (44921526330.63)                   (402326607264.55)                    (64197508417.40)
i(anio_fiscal, treatment, ref = 2014)2018                      4561282242.91                    -359128877125.61                       6504528311.64 
                                                             (60938074880.26)                   (350606083453.42)                    (88383966865.17)
i(anio_fiscal, treatment, ref = 2014)2019                    139768561988.67                     -50991191069.32                     162617367265.26 
                                                            (186967825351.70)                    (70798023199.69)                   (304381199461.77)
-----------------------------------------------------------------------------------------------------------------------------------------------------
r.squared                                                               0.00                                0.00                                0.00 
adj.r.squared                                                          -0.25                               -0.62                               -0.35 
statistic                                                               1.57                                0.66                                1.54 
p.value                                                                 0.09                                0.79                                0.10 
deviance                                   386051343585954336724284604002      293868153554951852208224246026      376791244392476696160826486822    
df.residual                                                         19227                                6044                               12091    
nobs                                                                24122                                9827                               16370    
=====================================================================================================================================================
*** p &lt; 0.001; ** p &lt; 0.01; * p &lt; 0.05</code></pre>
</div>
</div>
</div>
<div id="tabset-2-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-2-3-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="co"># With this code we construct our formula as a string to use in the model function.</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Check above to see the label of the dependent variable.</span></span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>fml_event_study <span class="ot">&lt;-</span> glue<span class="sc">::</span><span class="fu">glue</span>(<span class="st">'{dependent} ~  anio_fiscal + treatment + i(anio_fiscal,treatment, ref = 2014)'</span>) <span class="sc">%&gt;%</span></span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">formula</span>(.)</span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Model estimation:</span></span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a>es_model_fe <span class="ot">&lt;-</span> <span class="fu">plm</span>(<span class="at">data =</span> rtable,</span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a>                    <span class="at">formula =</span> fml_event_study,</span>
<span id="cb5-10"><a href="#cb5-10" aria-hidden="true" tabindex="-1"></a>                    <span class="at">index =</span> <span class="fu">c</span>(<span class="st">"firm_id"</span>,<span class="st">"anio_fiscal"</span>),</span>
<span id="cb5-11"><a href="#cb5-11" aria-hidden="true" tabindex="-1"></a>                    <span class="at">model =</span> <span class="st">"within"</span>)</span>
<span id="cb5-12"><a href="#cb5-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-13"><a href="#cb5-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Wald test using clustered matrix of variance/covariance:</span></span>
<span id="cb5-14"><a href="#cb5-14" aria-hidden="true" tabindex="-1"></a>vcov_cl <span class="ot">&lt;-</span> <span class="fu">vcovCL</span>(<span class="at">x =</span> es_model_fe,</span>
<span id="cb5-15"><a href="#cb5-15" aria-hidden="true" tabindex="-1"></a>                  <span class="at">cluster =</span> rtable<span class="sc">$</span>firm_id)</span>
<span id="cb5-16"><a href="#cb5-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-17"><a href="#cb5-17" aria-hidden="true" tabindex="-1"></a><span class="co"># Adjusted standard errors:</span></span>
<span id="cb5-18"><a href="#cb5-18" aria-hidden="true" tabindex="-1"></a>model_corrected <span class="ot">&lt;-</span> <span class="fu">coeftest</span>(<span class="at">vcov. =</span> vcov_cl,</span>
<span id="cb5-19"><a href="#cb5-19" aria-hidden="true" tabindex="-1"></a>                            <span class="at">x =</span> did_model_fe) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
</div>
</section>
<section id="event-study-design-assets-weighted-unsaturated-model" class="level2" data-number="1.3">
<h2 data-number="1.3" class="anchored" data-anchor-id="event-study-design-assets-weighted-unsaturated-model"><span class="header-section-number">1.3</span> Event Study design assets weighted (unsaturated model)</h2>
<p><span class="math display">\[Y_{it} = \beta_0 + \beta_1 \times Treatment_{i} + \beta_2 \times Post_{t} + \sum_{k \neq 2014} \beta_k \times Time_{k} \times Treatment_{i} + \epsilon_{it}\]</span></p>
<p><span class="math display">\[\text{Note: The model is weighted by: Total assets 2014.}\]</span></p>
<p>Where:</p>
<ul>
<li><span class="math inline">\(\{ k = 2012, \ldots, 2017 \}\)</span></li>
<li><span class="math inline">\(Y_{it}\)</span> is Change from t-1 assets attributable to tax havens (positive), the dependent variable.</li>
<li><span class="math inline">\(Treatment_{i}\)</span> is a dummy variable that is 1 if unit <span class="math inline">\(i\)</span> receives the treatment at time <span class="math inline">\(t\)</span>, and 0 otherwise.</li>
<li><span class="math inline">\(Time_{i}\)</span> are dummy variables that are 1 if the year is <span class="math inline">\(k\)</span>, and 0 otherwise. The year 2014 is the reference year and therefore does not appear in the equation.</li>
<li><span class="math inline">\(\epsilon_{it}\)</span> is the error term.</li>
</ul>
<p><strong>Dependent variable:</strong> Change from t-1 assets attributable to tax havens (positive)</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-3-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-3-1" role="tab" aria-controls="tabset-3-1" aria-selected="true" href="">Plot</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-3-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-3-2" role="tab" aria-controls="tabset-3-2" aria-selected="false" href="">Regression table</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-3-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-3-3" role="tab" aria-controls="tabset-3-3" aria-selected="false" href="">R Code</a></li></ul>
<div class="tab-content">
<div id="tabset-3-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-3-1-tab">
<div class="cell">
<div class="cell-output-display">
<p><img src="regression_transparency_files/figure-html/unnamed-chunk-10-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</div>
<div id="tabset-3-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-3-2-tab">
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>
=========================================================================================
                             All firms           CIT &gt;= Statutory     CIT &gt; 0            
-----------------------------------------------------------------------------------------
(Intercept)                  -6105934554727.96   -15512491466076.50   -12403024610602.31 
                             (5309397959975.63)  (13451167143552.53)  (10774469425224.63)
anio_fiscal                      3046066982.02        7736755709.62        6178132177.78 
                                (2648590728.13)      (6708484621.95)      (5366788485.91)
treatment                     1221738125784.35     2969291818167.21     1593018183244.62 
                             (1134965242532.91)   (2947963456511.73)   (1481024916604.19)
anio_fiscal::2013:treatment  -1131762931063.93    -2951127533725.48    -1464053308868.32 
                             (1132516290385.00)   (2947144085555.58)   (1478237084111.05)
anio_fiscal::2015:treatment   -202090150590.54    -2926107226490.06     -200395264663.59 
                              (160476007097.58)   (2948276409124.06)    (162304754695.94)
anio_fiscal::2016:treatment   -313175295882.65    -1195705776394.95     -204750587695.93 
                              (262820877097.56)   (1250780713175.28)    (172945181790.26)
anio_fiscal::2017:treatment   -252083113173.56    -1399282066406.04     -302058194992.73 
                              (187684255007.90)   (1387317984355.16)    (221911441030.68)
anio_fiscal::2018:treatment   -236266678078.12    -1532095362911.51     -216766222202.69 
                              (171442205939.94)   (1500591257298.62)    (156647993293.75)
anio_fiscal::2019:treatment   -167210205462.33     -503363427344.76       65267934414.69 
                              (110997972237.48)    (571473291082.73)    (234852364977.19)
-----------------------------------------------------------------------------------------
r.squared                                 0.00                 0.00                 0.00 
adj.r.squared                             0.00                 0.00                 0.00 
sigma                        21139766336793.89    31958135835618.74    25651454084342.70 
logLik                              -742116.47           -306395.17           -506790.24 
AIC                                 1484250.93            612808.33           1013598.48 
BIC                                 1484323.75            612873.07           1013667.81 
nobs                                  24122                 9827                16370    
=========================================================================================
*** p &lt; 0.001; ** p &lt; 0.01; * p &lt; 0.05</code></pre>
</div>
</div>
</div>
<div id="tabset-3-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-3-3-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="co"># With this code we construct our formula as a string to use in the model function.</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Check above to see the label of the dependent variable.</span></span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>fml_event_study <span class="ot">&lt;-</span> glue<span class="sc">::</span><span class="fu">glue</span>(<span class="st">'{dependent} ~  anio_fiscal + treatment + i(anio_fiscal,treatment, ref = 2014)'</span>) <span class="sc">%&gt;%</span></span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">formula</span>(.)</span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Model estimation:</span></span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a>es_model_aw <span class="ot">&lt;-</span> <span class="fu">feols</span>(<span class="at">data =</span> rtable,</span>
<span id="cb7-9"><a href="#cb7-9" aria-hidden="true" tabindex="-1"></a>                     <span class="at">fml =</span> fml_event_study,</span>
<span id="cb7-10"><a href="#cb7-10" aria-hidden="true" tabindex="-1"></a>                  <span class="at">weights =</span> <span class="sc">~</span>assets_2014,</span>
<span id="cb7-11"><a href="#cb7-11" aria-hidden="true" tabindex="-1"></a>                  <span class="at">cluster =</span> <span class="sc">~</span>firm_id)</span>
<span id="cb7-12"><a href="#cb7-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Wald test using clustered matrix of variance/covariance:</span></span>
<span id="cb7-13"><a href="#cb7-13" aria-hidden="true" tabindex="-1"></a>vcov_cl <span class="ot">&lt;-</span> <span class="fu">vcovCL</span>(<span class="at">x =</span> es_model_aw,</span>
<span id="cb7-14"><a href="#cb7-14" aria-hidden="true" tabindex="-1"></a>                  <span class="at">cluster =</span> rtable<span class="sc">$</span>firm_id)</span>
<span id="cb7-15"><a href="#cb7-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-16"><a href="#cb7-16" aria-hidden="true" tabindex="-1"></a><span class="co"># Adjusted standard errors:</span></span>
<span id="cb7-17"><a href="#cb7-17" aria-hidden="true" tabindex="-1"></a>model_corrected <span class="ot">&lt;-</span> <span class="fu">coeftest</span>(<span class="at">vcov. =</span> vcov_cl,</span>
<span id="cb7-18"><a href="#cb7-18" aria-hidden="true" tabindex="-1"></a>                            <span class="at">x =</span> did_model_fe) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
</div>
</section>
<section id="event-study-design-assets-weighted-with-fixed-effects" class="level2" data-number="1.4">
<h2 data-number="1.4" class="anchored" data-anchor-id="event-study-design-assets-weighted-with-fixed-effects"><span class="header-section-number">1.4</span> Event Study design assets weighted (with fixed effects)</h2>
<p><span class="math display">\[Y_{it} = \beta_0 + \beta_1 \times Treatment_{i} + \beta_2 \times Post_{t} + \sum_{k \neq 2014} \beta_k \times Time_{k} \times Treatment_{i} + \alpha_i + \gamma_t + \epsilon_{it}\]</span></p>
<p><span class="math display">\[\text{Note: The model is weighted by: Total assets 2014.}\]</span></p>
<p>Where:</p>
<ul>
<li><span class="math inline">\(\{ k = 2012, \ldots, 2017 \}\)</span></li>
<li><span class="math inline">\(Y_{it}\)</span> is Change from t-1 assets attributable to tax havens (positive), the dependent variable.</li>
<li><span class="math inline">\(Treatment_{i}\)</span> is a dummy variable that is 1 if unit <span class="math inline">\(i\)</span> receives the treatment at time <span class="math inline">\(t\)</span>, and 0 otherwise.</li>
<li><span class="math inline">\(Time_{i}\)</span> are dummy variables that are 1 if the year is <span class="math inline">\(k\)</span>, and 0 otherwise. The year 2014 is the reference year and therefore does not appear in the equation.</li>
<li><span class="math inline">\(alpha_i\)</span> are the fixed effects at firm level</li>
<li><span class="math inline">\(gamma_t\)</span> are the fixed effects at time</li>
<li><span class="math inline">\(\epsilon_{it}\)</span> is the error term.</li>
</ul>
<p><strong>Dependent variable:</strong> Change from t-1 assets attributable to tax havens (positive)</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-4-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-4-1" role="tab" aria-controls="tabset-4-1" aria-selected="true" href="">Plot</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-4-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-4-2" role="tab" aria-controls="tabset-4-2" aria-selected="false" href="">Regression table</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-4-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-4-3" role="tab" aria-controls="tabset-4-3" aria-selected="false" href="">R Code</a></li></ul>
<div class="tab-content">
<div id="tabset-4-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-4-1-tab">
<div class="cell">
<div class="cell-output-display">
<p><img src="regression_transparency_files/figure-html/unnamed-chunk-13-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</div>
<div id="tabset-4-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-4-2-tab">
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>
=======================================================================================
                             All firms           CIT &gt;= Statutory    CIT &gt; 0           
---------------------------------------------------------------------------------------
anio_fiscal::2013:treatment  -1233728098632.19     -64615398727.21   -1772167299018.04 
                             (1234877391688.25)   (315990183323.90)  (1774192613294.41)
anio_fiscal::2015:treatment   -181492689490.00    -119445598408.11    -272047320939.56 
                              (154564831759.91)   (297012955555.52)   (234223148568.40)
anio_fiscal::2016:treatment   -328674669939.65    -957148725800.49    -482473159279.90 
                              (207861759033.37)   (646092232569.89)   (323999010289.18)
anio_fiscal::2017:treatment    -31338972900.80    -193057268884.24     -61476470209.30 
                               (44522452040.17)   (390092540976.45)    (64563710909.49)
anio_fiscal::2018:treatment     -7243844736.56    -344697624274.87     -11629280117.98 
                               (56913892774.25)   (337859812188.33)    (80788803279.43)
anio_fiscal::2019:treatment    125033916644.85     -55304566381.33     137319579446.63 
                              (177195785249.59)    (72837999478.79)   (285568228480.07)
---------------------------------------------------------------------------------------
r.squared                                 0.49                0.59                0.50 
adj.r.squared                             0.36                0.33                0.33 
sigma                        16914236661374.27   26248861979755.73   21074189404511.48 
logLik                              -734186.45          -302170.02          -501217.99 
AIC                                 1478162.89           611906.04          1010993.98 
BIC                                 1517767.75           639116.74          1043955.99 
nobs                                  24122                9827               16370    
within.r.squared                          0.00                0.00                0.00 
=======================================================================================
*** p &lt; 0.001; ** p &lt; 0.01; * p &lt; 0.05</code></pre>
</div>
</div>
</div>
<div id="tabset-4-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-4-3-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="co"># With this code we construct our formula as a string to use in the model function.</span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Check above to see the label of the dependent variable.</span></span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a>  fml_event_study_fe <span class="ot">&lt;-</span> glue<span class="sc">::</span><span class="fu">glue</span>(<span class="st">'{dependent} ~  i(anio_fiscal,treatment, ref = 2014) | firm_id + anio_fiscal'</span>) <span class="sc">%&gt;%</span></span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">formula</span>(.)</span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Model estimation:</span></span>
<span id="cb9-8"><a href="#cb9-8" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb9-9"><a href="#cb9-9" aria-hidden="true" tabindex="-1"></a>es_model_aw_fe <span class="ot">&lt;-</span> <span class="fu">feols</span>(<span class="at">data =</span> rtable,</span>
<span id="cb9-10"><a href="#cb9-10" aria-hidden="true" tabindex="-1"></a>                        <span class="at">fml =</span> fml_event_study_fe,</span>
<span id="cb9-11"><a href="#cb9-11" aria-hidden="true" tabindex="-1"></a>                        <span class="at">weights =</span> <span class="sc">~</span>assets_2014,</span>
<span id="cb9-12"><a href="#cb9-12" aria-hidden="true" tabindex="-1"></a>                        <span class="at">cluster =</span> <span class="sc">~</span>firm_id)</span>
<span id="cb9-13"><a href="#cb9-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-14"><a href="#cb9-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Wald test using clustered matrix of variance/covariance:</span></span>
<span id="cb9-15"><a href="#cb9-15" aria-hidden="true" tabindex="-1"></a>vcov_cl <span class="ot">&lt;-</span> <span class="fu">vcovCL</span>(<span class="at">x =</span> es_model_aw_fe,</span>
<span id="cb9-16"><a href="#cb9-16" aria-hidden="true" tabindex="-1"></a>                  <span class="at">cluster =</span> rtable<span class="sc">$</span>firm_id)</span>
<span id="cb9-17"><a href="#cb9-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-18"><a href="#cb9-18" aria-hidden="true" tabindex="-1"></a><span class="co"># Adjusted standard errors:</span></span>
<span id="cb9-19"><a href="#cb9-19" aria-hidden="true" tabindex="-1"></a>model_corrected <span class="ot">&lt;-</span> <span class="fu">coeftest</span>(<span class="at">vcov. =</span> vcov_cl,</span>
<span id="cb9-20"><a href="#cb9-20" aria-hidden="true" tabindex="-1"></a>                            <span class="at">x =</span> did_model_fe) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
</div>
</section>
<section id="diff-in-diff-design-unsaturated-model" class="level2" data-number="1.5">
<h2 data-number="1.5" class="anchored" data-anchor-id="diff-in-diff-design-unsaturated-model"><span class="header-section-number">1.5</span> Diff-in-diff design (unsaturated model)</h2>
<p><span class="math display">\[Y_{it} = \beta_0 \times Treatment_{i} + \beta_1 \times Post_{t} + \beta_2 \times Treatment_{i} \times Post_{t} + \epsilon_{it}\]</span></p>
<p>Where:</p>
<ul>
<li><span class="math inline">\(Y_{it}\)</span> is Change from t-1 assets attributable to tax havens (positive), the dependent variable for unit <span class="math inline">\(i\)</span> at time <span class="math inline">\(t\)</span>.</li>
<li><span class="math inline">\(Treatment_{i}\)</span> is a dummy variable that is 1 if unit <span class="math inline">\(i\)</span> receives the treatment at time <span class="math inline">\(t\)</span>, and 0 otherwise.</li>
<li><span class="math inline">\(Post_{t}\)</span> is a dummy variable that is 1 if time <span class="math inline">\(t\)</span> is after the implementation of the treatment, and 0 otherwise.</li>
<li><span class="math inline">\(Treatment_{i} \times Post_{t}\)</span> is the interaction between the treatment and the post period, which captures the treatment effect in the difference-in-differences.</li>
</ul>
<p><strong>Dependent variable:</strong> Change from t-1 assets attributable to tax havens (positive)</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-5-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-5-1" role="tab" aria-controls="tabset-5-1" aria-selected="true" href="">Plot</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-5-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-5-2" role="tab" aria-controls="tabset-5-2" aria-selected="false" href="">Regression table</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-5-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-5-3" role="tab" aria-controls="tabset-5-3" aria-selected="false" href="">R Code</a></li></ul>
<div class="tab-content">
<div id="tabset-5-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-5-1-tab">
<div class="cell">
<div class="cell-output-display">
<p><img src="regression_transparency_files/figure-html/unnamed-chunk-16-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</div>
<div id="tabset-5-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-5-2-tab">
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>
==============================================================================================================================
                    All firms                           CIT &gt;= Statutory                    CIT &gt; 0                           
------------------------------------------------------------------------------------------------------------------------------
(Intercept)                               59080192.26                            70479.89                         78607110.45 
                                         (58826972.88)                          (58997.38)                       (78478543.37)
treatment                             676868210319.58                    1586175004102.86                     927017634335.13 
                                     (573880208765.48)                  (1517962519449.07)                   (785080005416.57)
postPost                               46292401488.84                     115912554365.81                      71882517500.69 
                                      (40602625143.45)                   (101536407767.41)                    (63037309724.40)
treatment:postPost                    300302938415.07                    -141986483418.22                     498072600068.78 
                                     (406077613421.47)                   (181405866333.34)                   (646139421904.36)
------------------------------------------------------------------------------------------------------------------------------
r.squared                                        0.00                                0.00                                0.00 
adj.r.squared                                    0.00                                0.00                                0.00 
sigma                                5558610640672.87                    8412513641756.17                    6744726884364.97 
statistic                                       14.17                                8.08                               13.94 
p.value                                          0.00                                0.00                                0.00 
df                                               3                                   3                                   3    
logLik                                     -742118.76                          -306400.71                          -506792.26 
AIC                                        1484247.51                           612811.43                          1013594.51 
BIC                                        1484287.97                           612847.39                          1013633.03 
deviance            745201636076483560000244246206      695177499445562206006208208004      744511282627359824724462828622    
df.residual                                  24118                                9823                               16366    
nobs                                         24122                                9827                               16370    
==============================================================================================================================
*** p &lt; 0.001; ** p &lt; 0.01; * p &lt; 0.05</code></pre>
</div>
</div>
</div>
<div id="tabset-5-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-5-3-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="co"># With this code we construct our formula as a string to use in the model function.</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Check above to see the label of the dependent variable.</span></span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a>fml <span class="ot">&lt;-</span> glue<span class="sc">::</span><span class="fu">glue</span>(<span class="st">'dependent_variable ~ treatment + post + treatment:post'</span>)<span class="sc">%&gt;%</span> </span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">formula</span>(.)</span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-7"><a href="#cb11-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Model estimation:</span></span>
<span id="cb11-8"><a href="#cb11-8" aria-hidden="true" tabindex="-1"></a>did_model <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="at">data =</span> rtable,</span>
<span id="cb11-9"><a href="#cb11-9" aria-hidden="true" tabindex="-1"></a>                  <span class="at">formula =</span> fml)</span>
<span id="cb11-10"><a href="#cb11-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-11"><a href="#cb11-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Wald test using clustered matrix of variance/covariance:</span></span>
<span id="cb11-12"><a href="#cb11-12" aria-hidden="true" tabindex="-1"></a>vcov_cl <span class="ot">&lt;-</span> <span class="fu">vcovCL</span>(<span class="at">x =</span> did_model,</span>
<span id="cb11-13"><a href="#cb11-13" aria-hidden="true" tabindex="-1"></a>                  <span class="at">cluster =</span> rtable<span class="sc">$</span>firm_id)</span>
<span id="cb11-14"><a href="#cb11-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-15"><a href="#cb11-15" aria-hidden="true" tabindex="-1"></a><span class="co"># Adjusted standard errors:</span></span>
<span id="cb11-16"><a href="#cb11-16" aria-hidden="true" tabindex="-1"></a>model_corrected <span class="ot">&lt;-</span> <span class="fu">coeftest</span>(<span class="at">vcov. =</span> vcov_cl,</span>
<span id="cb11-17"><a href="#cb11-17" aria-hidden="true" tabindex="-1"></a>                            <span class="at">x =</span> did_model) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
</div>
</section>
<section id="diff-in-diff-design-with-fixed-effects" class="level2" data-number="1.6">
<h2 data-number="1.6" class="anchored" data-anchor-id="diff-in-diff-design-with-fixed-effects"><span class="header-section-number">1.6</span> Diff-in-diff design (with fixed effects)</h2>
<p><span class="math display">\[Y_{it} = \beta_0 + \beta_1 \times Treatment_{i} + \beta_2 \times Post_{t} + \beta_3 \times Treatment_{i} \times Post_{t} + \alpha_i + \gamma_t + \epsilon_{it}\]</span></p>
<p>Where:</p>
<ul>
<li><span class="math inline">\(Y_{it}\)</span> is Change from t-1 assets attributable to tax havens (positive), the dependent variable for unit <span class="math inline">\(i\)</span> at time <span class="math inline">\(t\)</span>.</li>
<li><span class="math inline">\(Treatment_{i}\)</span> is a dummy variable that is 1 if unit <span class="math inline">\(i\)</span> receives the treatment at time <span class="math inline">\(t\)</span>, and 0 otherwise.</li>
<li><span class="math inline">\(Post_{t}\)</span> is a dummy variable that is 1 if time <span class="math inline">\(t\)</span> is after the implementation of the treatment, and 0 otherwise.</li>
<li><span class="math inline">\(Treatment_{i} \times Post_{t}\)</span> is the interaction between the treatment and the post period, which captures the treatment effect in the difference-in-differences.</li>
<li><span class="math inline">\(\alpha_i\)</span> is the fixed effect for unit <span class="math inline">\(i\)</span>, which captures time-invariant characteristics of each unit.</li>
<li><span class="math inline">\(\gamma_t\)</span> is the fixed effect for time <span class="math inline">\(t\)</span>, which captures any time shock that affects all units in the same way.</li>
<li><span class="math inline">\(\epsilon_{it}\)</span> is the error term.</li>
</ul>
<p><strong>Dependent variable:</strong> Change from t-1 assets attributable to tax havens (positive)</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-6-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-6-1" role="tab" aria-controls="tabset-6-1" aria-selected="true" href="">Plot</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-6-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-6-2" role="tab" aria-controls="tabset-6-2" aria-selected="false" href="">Regression table</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-6-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-6-3" role="tab" aria-controls="tabset-6-3" aria-selected="false" href="">R Code</a></li></ul>
<div class="tab-content">
<div id="tabset-6-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-6-1-tab">
<div class="cell">
<div class="cell-output-display">
<p><img src="regression_transparency_files/figure-html/unnamed-chunk-19-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</div>
<div id="tabset-6-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-6-2-tab">
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>
==============================================================================================================================
                    All firms                           CIT &gt;= Statutory                    CIT &gt; 0                           
------------------------------------------------------------------------------------------------------------------------------
postPost                               47507298030.34                     136494609243.92                      85503391841.59 
                                      (41670524213.78)                   (124336699691.32)                    (76219340533.87)
treatment:postPost                    487320302265.24                    -319136626737.81                     697238349849.88 
                                     (572641929420.86)                   (222670593423.83)                   (837824348062.86)
------------------------------------------------------------------------------------------------------------------------------
r.squared                                        0.00                                0.00                                0.00 
adj.r.squared                                   -0.25                               -0.62                               -0.35 
statistic                                        2.13                                0.27                                2.10 
p.value                                          0.12                                0.76                                0.12 
deviance            386343846834864295968668882268      294227136991014303306248040466      377235901441817952388268820468    
df.residual                                  19237                                6054                               12101    
nobs                                         24122                                9827                               16370    
==============================================================================================================================
*** p &lt; 0.001; ** p &lt; 0.01; * p &lt; 0.05</code></pre>
</div>
</div>
</div>
<div id="tabset-6-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-6-3-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="co"># With this code we construct our formula as a string to use in the model function.</span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Check above to see the label of the dependent variable.</span></span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a>fml <span class="ot">&lt;-</span> glue<span class="sc">::</span><span class="fu">glue</span>(<span class="st">'dependent_variable ~ treatment + post + treatment:post'</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">formula</span>(.)</span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Model estimation:</span></span>
<span id="cb13-8"><a href="#cb13-8" aria-hidden="true" tabindex="-1"></a>did_model_fe <span class="ot">&lt;-</span> <span class="fu">plm</span>(<span class="at">data =</span> rtable,</span>
<span id="cb13-9"><a href="#cb13-9" aria-hidden="true" tabindex="-1"></a>                    <span class="at">formula =</span> fml,</span>
<span id="cb13-10"><a href="#cb13-10" aria-hidden="true" tabindex="-1"></a>                    <span class="at">index =</span> <span class="fu">c</span>(<span class="st">"firm_id"</span>,<span class="st">"anio_fiscal"</span>),</span>
<span id="cb13-11"><a href="#cb13-11" aria-hidden="true" tabindex="-1"></a>                    <span class="at">model =</span> <span class="st">"within"</span>)</span>
<span id="cb13-12"><a href="#cb13-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-13"><a href="#cb13-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Wald test using clustered matrix of variance/covariance:</span></span>
<span id="cb13-14"><a href="#cb13-14" aria-hidden="true" tabindex="-1"></a>vcov_cl <span class="ot">&lt;-</span> <span class="fu">vcovCL</span>(<span class="at">x =</span> did_model_fe,</span>
<span id="cb13-15"><a href="#cb13-15" aria-hidden="true" tabindex="-1"></a>                  <span class="at">cluster =</span> rtable<span class="sc">$</span>firm_id)</span>
<span id="cb13-16"><a href="#cb13-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-17"><a href="#cb13-17" aria-hidden="true" tabindex="-1"></a><span class="co"># Adjusted standard errors:</span></span>
<span id="cb13-18"><a href="#cb13-18" aria-hidden="true" tabindex="-1"></a>model_corrected <span class="ot">&lt;-</span> <span class="fu">coeftest</span>(<span class="at">vcov. =</span> vcov_cl,</span>
<span id="cb13-19"><a href="#cb13-19" aria-hidden="true" tabindex="-1"></a>                            <span class="at">x =</span> did_model_fe) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
</div>
</section>
<section id="diff-in-diff-design-assets-weighted-unsaturated-model" class="level2" data-number="1.7">
<h2 data-number="1.7" class="anchored" data-anchor-id="diff-in-diff-design-assets-weighted-unsaturated-model"><span class="header-section-number">1.7</span> Diff-in-diff design assets weighted (unsaturated model)</h2>
<p><span class="math display">\[Y_{it} = \beta_0 \times Treatment_{i} + \beta_1 \times Post_{t} + \beta_2 \times Treatment_{i} \times Post_{t} + \epsilon_{it}\]</span> <span class="math display">\[\text{Note: The model is weighted by: Total assets 2014.}\]</span></p>
<p>Where:</p>
<ul>
<li><span class="math inline">\(Y_{it}\)</span> is Change from t-1 assets attributable to tax havens (positive), the dependent variable for unit <span class="math inline">\(i\)</span> at time <span class="math inline">\(t\)</span>.</li>
<li><span class="math inline">\(Treatment_{i}\)</span> is a dummy variable that is 1 if unit <span class="math inline">\(i\)</span> receives the treatment at time <span class="math inline">\(t\)</span>, and 0 otherwise.</li>
<li><span class="math inline">\(Post_{t}\)</span> is a dummy variable that is 1 if time <span class="math inline">\(t\)</span> is after the implementation of the treatment, and 0 otherwise.</li>
<li><span class="math inline">\(Treatment_{i} \times Post_{t}\)</span> is the interaction between the treatment and the post period, which captures the treatment effect in the difference-in-differences.</li>
</ul>
<p><strong>Dependent variable:</strong> Change from t-1 assets attributable to tax havens (positive)</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-7-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-7-1" role="tab" aria-controls="tabset-7-1" aria-selected="true" href="">Plot</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-7-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-7-2" role="tab" aria-controls="tabset-7-2" aria-selected="false" href="">Regression table</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-7-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-7-3" role="tab" aria-controls="tabset-7-3" aria-selected="false" href="">R Code</a></li></ul>
<div class="tab-content">
<div id="tabset-7-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-7-1-tab">
<div class="cell">
<div class="cell-output-display">
<p><img src="regression_transparency_files/figure-html/unnamed-chunk-22-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</div>
<div id="tabset-7-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-7-2-tab">
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>
====================================================================================================================================
                    All firms                             CIT &gt;= Statutory                      CIT &gt; 0                             
------------------------------------------------------------------------------------------------------------------------------------
(Intercept)                                 77677397.67                              86588.80                          102294665.17 
                                           (77365286.98)                            (46413.81)                        (102125792.53)
treatment                               689086689528.87                      1570420468219.92                       932010043899.91 
                                       (576892310751.99)                    (1491989778411.88)                     (779448520356.79)
postPost                                 49280012165.50                       118996275524.44                        75087540036.75 
                                        (42667840268.00)                     (102868959993.48)                      (65000556987.31)
treatment:postPost                      285885223819.87                      -175291023890.76                       466983185469.80 
                                       (402030520419.99)                     (190190561842.77)                     (627332924467.57)
------------------------------------------------------------------------------------------------------------------------------------
r.squared                                          0.00                                  0.00                                  0.00 
adj.r.squared                                      0.00                                  0.00                                  0.00 
sigma                                 21139631317876.67                     31967929701485.90                     25650734692635.63 
statistic                                         14.44                                  7.98                                 13.97 
p.value                                            0.00                                  0.00                                  0.00 
df                                                 3                                     3                                     3    
logLik                                       -743049.93                            -306625.94                            -507293.77 
AIC                                          1486109.86                             613261.89                            1014597.54 
BIC                                          1486150.32                             613297.85                            1014636.06 
deviance            10777948607584229343422848846084      10038600404287796098468460600882      10768176473991248761862060808486    
df.residual                                    24118                                  9823                                 16366    
nobs                                           24122                                  9827                                 16370    
====================================================================================================================================
*** p &lt; 0.001; ** p &lt; 0.01; * p &lt; 0.05</code></pre>
</div>
</div>
</div>
<div id="tabset-7-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-7-3-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="co"># With this code we construct our formula as a string to use in the model function.</span></span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Check above to see the label of the dependent variable.</span></span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a>fml <span class="ot">&lt;-</span> glue<span class="sc">::</span><span class="fu">glue</span>(<span class="st">'dependent_variable ~ treatment + post + treatment:post'</span>)<span class="sc">%&gt;%</span> </span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">formula</span>(.)</span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-7"><a href="#cb15-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Model estimation:</span></span>
<span id="cb15-8"><a href="#cb15-8" aria-hidden="true" tabindex="-1"></a>did_model_aw <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="at">data =</span> rtable,</span>
<span id="cb15-9"><a href="#cb15-9" aria-hidden="true" tabindex="-1"></a>                   <span class="at">formula =</span> fml,</span>
<span id="cb15-10"><a href="#cb15-10" aria-hidden="true" tabindex="-1"></a>                   <span class="at">weights =</span> assets_2014)</span>
<span id="cb15-11"><a href="#cb15-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-12"><a href="#cb15-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Wald test using clustered matrix of variance/covariance:</span></span>
<span id="cb15-13"><a href="#cb15-13" aria-hidden="true" tabindex="-1"></a>vcov_cl <span class="ot">&lt;-</span> <span class="fu">vcovCL</span>(<span class="at">x =</span> did_model,</span>
<span id="cb15-14"><a href="#cb15-14" aria-hidden="true" tabindex="-1"></a>                  <span class="at">cluster =</span> rtable<span class="sc">$</span>firm_id)</span>
<span id="cb15-15"><a href="#cb15-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-16"><a href="#cb15-16" aria-hidden="true" tabindex="-1"></a><span class="co"># Adjusted standard errors:</span></span>
<span id="cb15-17"><a href="#cb15-17" aria-hidden="true" tabindex="-1"></a>model_corrected <span class="ot">&lt;-</span> <span class="fu">coeftest</span>(<span class="at">vcov. =</span> vcov_cl,</span>
<span id="cb15-18"><a href="#cb15-18" aria-hidden="true" tabindex="-1"></a>                            <span class="at">x =</span> did_model) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
</div>
</section>
<section id="diff-in-diff-design-assets-weighted-with-fixed-effects" class="level2" data-number="1.8">
<h2 data-number="1.8" class="anchored" data-anchor-id="diff-in-diff-design-assets-weighted-with-fixed-effects"><span class="header-section-number">1.8</span> Diff-in-diff design assets weighted (with fixed effects)</h2>
<p><span class="math display">\[Y_{it} = \beta_0 + \beta_1 \times Treatment_{i} + \beta_2 \times Post_{t} + \beta_3 \times Treatment_{i} \times Post_{t} + \alpha_i + \gamma_t + \epsilon_{it}\]</span></p>
<p><span class="math display">\[\text{Note: The model is weighted by: Total assets 2014.}\]</span></p>
<p>Where:</p>
<ul>
<li><span class="math inline">\(Y_{it}\)</span> is Change from t-1 assets attributable to tax havens (positive), the dependent variable for unit <span class="math inline">\(i\)</span> at time <span class="math inline">\(t\)</span>.</li>
<li><span class="math inline">\(Treatment_{i}\)</span> is a dummy variable that is 1 if unit <span class="math inline">\(i\)</span> receives the treatment at time <span class="math inline">\(t\)</span>, and 0 otherwise.</li>
<li><span class="math inline">\(Post_{t}\)</span> is a dummy variable that is 1 if time <span class="math inline">\(t\)</span> is after the implementation of the treatment, and 0 otherwise.</li>
<li><span class="math inline">\(Treatment_{i} \times Post_{t}\)</span> is the interaction between the treatment and the post period, which captures the treatment effect in the difference-in-differences.</li>
<li><span class="math inline">\(\alpha_i\)</span> is the fixed effect for unit <span class="math inline">\(i\)</span>, which captures time-invariant characteristics of each unit.</li>
<li><span class="math inline">\(\gamma_t\)</span> is the fixed effect for time <span class="math inline">\(t\)</span>, which captures any time shock that affects all units in the same way.</li>
<li><span class="math inline">\(\epsilon_{it}\)</span> is the error term.</li>
</ul>
<p><strong>Dependent variable:</strong> Change from t-1 assets attributable to tax havens (positive)</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-8-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-8-1" role="tab" aria-controls="tabset-8-1" aria-selected="true" href="">Plot</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-8-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-8-2" role="tab" aria-controls="tabset-8-2" aria-selected="false" href="">Regression table</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-8-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-8-3" role="tab" aria-controls="tabset-8-3" aria-selected="false" href="">R Code</a></li></ul>
<div class="tab-content">
<div id="tabset-8-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-8-1-tab">
<div class="cell">
<div class="cell-output-display">
<p><img src="regression_transparency_files/figure-html/unnamed-chunk-25-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</div>
<div id="tabset-8-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-8-2-tab">
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>
==============================================================================
                    All firms           CIT &gt;= Statutory    CIT &gt; 0           
------------------------------------------------------------------------------
treatment:postPost    475829076829.59    -310272088235.75     675193940283.74 
                     (565471790914.68)   (216971508806.15)   (812813672948.67)
------------------------------------------------------------------------------
r.squared                        0.49                0.59                0.50 
adj.r.squared                    0.36                0.33                0.33 
sigma               16916083081800.99   26240402777141.39   21077142229673.89 
logLik                     -734192.02          -302170.83          -501223.57 
AIC                        1478164.05           611897.67          1010995.13 
BIC                        1517728.45           639072.40          1043918.63 
nobs                         24122                9827               16370    
within.r.squared                 0.00                0.00                0.00 
==============================================================================
*** p &lt; 0.001; ** p &lt; 0.01; * p &lt; 0.05</code></pre>
</div>
</div>
</div>
<div id="tabset-8-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-8-3-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="co"># With this code we construct our formula as a string to use in the model function.</span></span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Check above to see the label of the dependent variable.</span></span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a>fml <span class="ot">&lt;-</span> glue<span class="sc">::</span><span class="fu">glue</span>(<span class="st">'dependent_variable ~ treatment + post + treatment:post'</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">formula</span>(.)</span>
<span id="cb17-6"><a href="#cb17-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-7"><a href="#cb17-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Model estimation:</span></span>
<span id="cb17-8"><a href="#cb17-8" aria-hidden="true" tabindex="-1"></a>did_model_fe_aw <span class="ot">&lt;-</span> <span class="fu">feols</span>(<span class="at">data =</span> rtable,</span>
<span id="cb17-9"><a href="#cb17-9" aria-hidden="true" tabindex="-1"></a>                         <span class="at">fml =</span> fml_fe,</span>
<span id="cb17-10"><a href="#cb17-10" aria-hidden="true" tabindex="-1"></a>                         <span class="at">weights =</span> <span class="sc">~</span>assets_2014,</span>
<span id="cb17-11"><a href="#cb17-11" aria-hidden="true" tabindex="-1"></a>                         <span class="at">cluster =</span> <span class="sc">~</span>firm_id)</span>
<span id="cb17-12"><a href="#cb17-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-13"><a href="#cb17-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Wald test using clustered matrix of variance/covariance:</span></span>
<span id="cb17-14"><a href="#cb17-14" aria-hidden="true" tabindex="-1"></a>vcov_cl <span class="ot">&lt;-</span> <span class="fu">vcovCL</span>(<span class="at">x =</span> did_model_fe,</span>
<span id="cb17-15"><a href="#cb17-15" aria-hidden="true" tabindex="-1"></a>                  <span class="at">cluster =</span> rtable<span class="sc">$</span>firm_id)</span>
<span id="cb17-16"><a href="#cb17-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-17"><a href="#cb17-17" aria-hidden="true" tabindex="-1"></a><span class="co"># Adjusted standard errors:</span></span>
<span id="cb17-18"><a href="#cb17-18" aria-hidden="true" tabindex="-1"></a>model_corrected <span class="ot">&lt;-</span> <span class="fu">coeftest</span>(<span class="at">vcov. =</span> vcov_cl,</span>
<span id="cb17-19"><a href="#cb17-19" aria-hidden="true" tabindex="-1"></a>                            <span class="at">x =</span> did_model_fe) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
</div>
</section>
</section>
<section id="major-groups-t-maj-vs-c-maj" class="level1" data-number="2">
<h1 data-number="2"><span class="header-section-number">2</span> Major groups (T-Maj vs C-Maj)</h1>
<section id="event-study-design-unsaturated-model-1" class="level2" data-number="2.1">
<h2 data-number="2.1" class="anchored" data-anchor-id="event-study-design-unsaturated-model-1"><span class="header-section-number">2.1</span> Event Study design (unsaturated model)</h2>
<p><span class="math display">\[Y_{it} = \beta_0 + \beta_1 \times Treatment_{i} + \beta_2 \times Post_{t} + \sum_{k \neq 2014} \beta_k \times Time_{k} \times Treatment_{i} + \epsilon_{it}\]</span></p>
<p>Where:</p>
<ul>
<li><span class="math inline">\(\{ k = 2012, \ldots, 2017 \}\)</span></li>
<li><span class="math inline">\(Y_{it}\)</span> is Change from t-1 assets attributable to tax havens (positive), the dependent variable.</li>
<li><span class="math inline">\(Treatment_{i}\)</span> is a dummy variable that is 1 if unit <span class="math inline">\(i\)</span> receives the treatment at time <span class="math inline">\(t\)</span>, and 0 otherwise.</li>
<li><span class="math inline">\(Time_{i}\)</span> are dummy variables that are 1 if the year is <span class="math inline">\(k\)</span>, and 0 otherwise. The year 2014 is the reference year and therefore does not appear in the equation.</li>
<li><span class="math inline">\(\epsilon_{it}\)</span> is the error term.</li>
</ul>
<p><strong>Dependent variable:</strong> Change from t-1 assets attributable to tax havens (positive)</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-9-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-9-1" role="tab" aria-controls="tabset-9-1" aria-selected="true" href="">Plot</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-9-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-9-2" role="tab" aria-controls="tabset-9-2" aria-selected="false" href="">Regression table</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-9-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-9-3" role="tab" aria-controls="tabset-9-3" aria-selected="false" href="">R Code</a></li></ul>
<div class="tab-content">
<div id="tabset-9-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-9-1-tab">
<div class="cell">
<div class="cell-output-display">
<p><img src="regression_transparency_files/figure-html/unnamed-chunk-29-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</div>
<div id="tabset-9-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-9-2-tab">
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>
=====================================================================================================================================================
                                           All firms                           CIT &gt;= Statutory                    CIT &gt; 0                           
-----------------------------------------------------------------------------------------------------------------------------------------------------
(Intercept)                                                -6873911992922.95                  -21391175653161.24                  -15750175796198.88 
                                                           (6056195695018.29)                 (18811785054893.96)                 (13861877868863.46)
anio_fiscal                                                    3430982526.80                      10664336342.99                       7845336921.65 
                                                              (3022700948.38)                     (9378128944.30)                     (6904590407.49)
treatment                                                   2240092241317.87                    6192803481425.35                    3161500281555.74 
                                                           (2077240531447.56)                  (6079698023050.28)                  (2925887679029.65)
i(anio_fiscal, treatment, ref = 2014)2013                  -2082795890851.32                   -6138655531837.01                   -2897285414594.50 
                                                           (2074292936721.84)                  (6079716752506.31)                  (2924210618922.54)
i(anio_fiscal, treatment, ref = 2014)2015                   -150710728696.38                   -6000656175752.84                     -27007267193.82 
                                                            (149827748362.98)                  (6081180780583.67)                   (296431724311.62)
i(anio_fiscal, treatment, ref = 2014)2016                   -623162609296.80                   -2436388830004.42                    -358328338149.66 
                                                            (534424770584.86)                  (2593741513157.45)                   (388137184790.54)
i(anio_fiscal, treatment, ref = 2014)2017                   -570077675206.00                   -3121990793671.05                    -772027423673.08 
                                                            (473835311076.99)                  (3125953990526.88)                   (653176159607.23)
i(anio_fiscal, treatment, ref = 2014)2018                   -549012217167.90                   -3556530507530.30                    -703260049948.35 
                                                            (452169014946.17)                  (3499790252485.08)                   (593928469008.10)
i(anio_fiscal, treatment, ref = 2014)2019                   -519666993866.72                   -1046545033881.58                     -91382310192.43 
                                                            (413440102613.17)                  (1439905389836.66)                   (426459344112.68)
-----------------------------------------------------------------------------------------------------------------------------------------------------
r.squared                                                               0.00                                0.01                                0.01 
adj.r.squared                                                           0.00                                0.01                                0.00 
sigma                                                       6438348089110.04                    9778106645356.14                    7864032590905.94 
statistic                                                               8.02                                6.66                                8.32 
p.value                                                                 0.00                                0.00                                0.00 
df                                                                      8                                   8                                   8    
logLik                                                            -554931.88                          -226919.45                          -373653.73 
AIC                                                               1109883.76                           453858.90                           747327.46 
BIC                                                               1109961.72                           453927.78                           747401.40 
deviance                                   743779087509201508244622408420      691652647454607630584682888440      742177946098560426806202200044    
df.residual                                                         17943                                7234                               12001    
nobs                                                                17952                                7243                               12010    
=====================================================================================================================================================
*** p &lt; 0.001; ** p &lt; 0.01; * p &lt; 0.05</code></pre>
</div>
</div>
</div>
<div id="tabset-9-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-9-3-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="co"># With this code we construct our formula as a string to use in the model function.</span></span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Check above to see the label of the dependent variable.</span></span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a>fml_event_study <span class="ot">&lt;-</span> glue<span class="sc">::</span><span class="fu">glue</span>(<span class="st">'{dependent} ~  anio_fiscal + treatment + i(anio_fiscal,treatment, ref = 2014)'</span>) <span class="sc">%&gt;%</span></span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">formula</span>(.)</span>
<span id="cb19-6"><a href="#cb19-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-7"><a href="#cb19-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Model estimation:</span></span>
<span id="cb19-8"><a href="#cb19-8" aria-hidden="true" tabindex="-1"></a>es_model <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="at">data =</span> rtable,</span>
<span id="cb19-9"><a href="#cb19-9" aria-hidden="true" tabindex="-1"></a>               <span class="at">formula =</span> fml_event_study)</span>
<span id="cb19-10"><a href="#cb19-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-11"><a href="#cb19-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Wald test using clustered matrix of variance/covariance:</span></span>
<span id="cb19-12"><a href="#cb19-12" aria-hidden="true" tabindex="-1"></a>vcov_cl <span class="ot">&lt;-</span> <span class="fu">vcovCL</span>(<span class="at">x =</span> es_model,</span>
<span id="cb19-13"><a href="#cb19-13" aria-hidden="true" tabindex="-1"></a>                  <span class="at">cluster =</span> rtable<span class="sc">$</span>firm_id)</span>
<span id="cb19-14"><a href="#cb19-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-15"><a href="#cb19-15" aria-hidden="true" tabindex="-1"></a><span class="co"># Adjusted standard errors:</span></span>
<span id="cb19-16"><a href="#cb19-16" aria-hidden="true" tabindex="-1"></a>model_corrected <span class="ot">&lt;-</span> <span class="fu">coeftest</span>(<span class="at">vcov. =</span> vcov_cl,</span>
<span id="cb19-17"><a href="#cb19-17" aria-hidden="true" tabindex="-1"></a>                            <span class="at">x =</span> did_model_fe) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
</div>
</section>
<section id="event-study-design-with-fixed-effects-1" class="level2" data-number="2.2">
<h2 data-number="2.2" class="anchored" data-anchor-id="event-study-design-with-fixed-effects-1"><span class="header-section-number">2.2</span> Event Study design (with fixed effects)</h2>
<p><span class="math display">\[Y_{it} = \beta_0 + \beta_1 \times Treatment_{i} + \beta_2 \times Post_{t} + \sum_{k \neq 2014} \beta_k \times Time_{k} \times Treatment_{i} + \alpha_i + \gamma_t + \epsilon_{it}\]</span></p>
<p>Where:</p>
<ul>
<li><span class="math inline">\(\{ k = 2012, \ldots, 2017 \}\)</span></li>
<li><span class="math inline">\(Y_{it}\)</span> is Change from t-1 assets attributable to tax havens (positive), the dependent variable.</li>
<li><span class="math inline">\(Treatment_{i}\)</span> is a dummy variable that is 1 if unit <span class="math inline">\(i\)</span> receives the treatment at time <span class="math inline">\(t\)</span>, and 0 otherwise.</li>
<li><span class="math inline">\(Time_{i}\)</span> are dummy variables that are 1 if the year is <span class="math inline">\(k\)</span>, and 0 otherwise. The year 2014 is the reference year and therefore does not appear in the equation.</li>
<li><span class="math inline">\(alpha_i\)</span> are the fixed effects at firm level</li>
<li><span class="math inline">\(gamma_t\)</span> are the fixed effects at time</li>
<li><span class="math inline">\(\epsilon_{it}\)</span> is the error term.</li>
</ul>
<p><strong>Dependent variable:</strong> Change from t-1 assets attributable to tax havens (positive)</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-10-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-10-1" role="tab" aria-controls="tabset-10-1" aria-selected="true" href="">Plot</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-10-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-10-2" role="tab" aria-controls="tabset-10-2" aria-selected="false" href="">Regression table</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-10-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-10-3" role="tab" aria-controls="tabset-10-3" aria-selected="false" href="">R Code</a></li></ul>
<div class="tab-content">
<div id="tabset-10-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-10-1-tab">
<div class="cell">
<div class="cell-output-display">
<p><img src="regression_transparency_files/figure-html/unnamed-chunk-32-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</div>
<div id="tabset-10-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-10-2-tab">
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>
=====================================================================================================================================================
                                           All firms                           CIT &gt;= Statutory                    CIT &gt; 0                           
-----------------------------------------------------------------------------------------------------------------------------------------------------
anio_fiscal2014                                                7560009001.08                     249569622764.14                      13725102005.52 
                                                              (6794738663.64)                   (227459500066.41)                    (12454892900.78)
anio_fiscal2015                                               17558958620.50                      92663988765.41                      31190678498.57 
                                                             (15553740506.92)                    (84677093167.63)                    (27905894796.66)
anio_fiscal2016                                              271243039610.99                     954597635476.29                     463910122970.45 
                                                            (237815185776.34)                   (838014459233.20)                   (406926132403.92)
anio_fiscal2017                                               -5930415706.05                      23338700865.06                     -10551525752.03 
                                                              (5143710405.93)                    (26595247465.86)                     (9138235362.92)
anio_fiscal2018                                              -15130436006.68                     231909011102.21                     -28991464546.41 
                                                             (13153176151.37)                   (233524730636.60)                    (24902539233.66)
anio_fiscal2019                                              -20360959663.53                     216272415838.72                      61685056328.11 
                                                             (17717252364.52)                   (238213439573.35)                    (68487868156.87)
i(anio_fiscal, treatment, ref = 2014)2013                  -2289089469139.75                    -337547476490.38                   -3889797524401.56 
                                                           (2282455380050.69)                   (626595224434.14)                  (3869667780175.61)
i(anio_fiscal, treatment, ref = 2014)2015                   -285180494782.73                    -432038218213.57                    -542184667688.63 
                                                            (243002765247.78)                   (691407764836.37)                   (479597913754.63)
i(anio_fiscal, treatment, ref = 2014)2016                   -388152645447.92                   -1700232401347.05                    -572861925591.39 
                                                            (249109352992.99)                  (1206608288400.89)                   (419197411010.82)
i(anio_fiscal, treatment, ref = 2014)2017                    118611237581.23                    -627302375197.21                      88687240067.54 
                                                            (230804640762.34)                   (835508114250.89)                   (287545559607.69)
i(anio_fiscal, treatment, ref = 2014)2018                    165590391723.78                    -787191969347.78                     192413152345.66 
                                                            (274484756730.52)                   (761546006321.38)                   (371871619731.21)
i(anio_fiscal, treatment, ref = 2014)2019                    410649531095.83                     -89559033184.97                     644069802554.29 
                                                            (522638366633.97)                   (179652164956.52)                   (926528070310.61)
-----------------------------------------------------------------------------------------------------------------------------------------------------
r.squared                                                               0.00                                0.00                                0.00 
adj.r.squared                                                          -0.25                               -0.62                               -0.35 
statistic                                                               2.03                                0.66                                2.17 
p.value                                                                 0.02                                0.79                                0.01 
deviance                                   385772032278335597322048006480      293731600267470198042646468086      376262423564858504842088802402    
df.residual                                                         14361                                4462                                8881    
nobs                                                                17952                                7243                               12010    
=====================================================================================================================================================
*** p &lt; 0.001; ** p &lt; 0.01; * p &lt; 0.05</code></pre>
</div>
</div>
</div>
<div id="tabset-10-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-10-3-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="co"># With this code we construct our formula as a string to use in the model function.</span></span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Check above to see the label of the dependent variable.</span></span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a>fml_event_study <span class="ot">&lt;-</span> glue<span class="sc">::</span><span class="fu">glue</span>(<span class="st">'{dependent} ~  anio_fiscal + treatment + i(anio_fiscal,treatment, ref = 2014)'</span>) <span class="sc">%&gt;%</span></span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">formula</span>(.)</span>
<span id="cb21-6"><a href="#cb21-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-7"><a href="#cb21-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Model estimation:</span></span>
<span id="cb21-8"><a href="#cb21-8" aria-hidden="true" tabindex="-1"></a>es_model_fe <span class="ot">&lt;-</span> <span class="fu">plm</span>(<span class="at">data =</span> rtable,</span>
<span id="cb21-9"><a href="#cb21-9" aria-hidden="true" tabindex="-1"></a>                    <span class="at">formula =</span> fml_event_study,</span>
<span id="cb21-10"><a href="#cb21-10" aria-hidden="true" tabindex="-1"></a>                    <span class="at">index =</span> <span class="fu">c</span>(<span class="st">"firm_id"</span>,<span class="st">"anio_fiscal"</span>),</span>
<span id="cb21-11"><a href="#cb21-11" aria-hidden="true" tabindex="-1"></a>                    <span class="at">model =</span> <span class="st">"within"</span>)</span>
<span id="cb21-12"><a href="#cb21-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-13"><a href="#cb21-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Wald test using clustered matrix of variance/covariance:</span></span>
<span id="cb21-14"><a href="#cb21-14" aria-hidden="true" tabindex="-1"></a>vcov_cl <span class="ot">&lt;-</span> <span class="fu">vcovCL</span>(<span class="at">x =</span> es_model_fe,</span>
<span id="cb21-15"><a href="#cb21-15" aria-hidden="true" tabindex="-1"></a>                  <span class="at">cluster =</span> rtable<span class="sc">$</span>firm_id)</span>
<span id="cb21-16"><a href="#cb21-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-17"><a href="#cb21-17" aria-hidden="true" tabindex="-1"></a><span class="co"># Adjusted standard errors:</span></span>
<span id="cb21-18"><a href="#cb21-18" aria-hidden="true" tabindex="-1"></a>model_corrected <span class="ot">&lt;-</span> <span class="fu">coeftest</span>(<span class="at">vcov. =</span> vcov_cl,</span>
<span id="cb21-19"><a href="#cb21-19" aria-hidden="true" tabindex="-1"></a>                            <span class="at">x =</span> did_model_fe) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
</div>
</section>
<section id="event-study-design-assets-weighted-unsaturated-model-1" class="level2" data-number="2.3">
<h2 data-number="2.3" class="anchored" data-anchor-id="event-study-design-assets-weighted-unsaturated-model-1"><span class="header-section-number">2.3</span> Event Study design assets weighted (unsaturated model)</h2>
<p><span class="math display">\[Y_{it} = \beta_0 + \beta_1 \times Treatment_{i} + \beta_2 \times Post_{t} + \sum_{k \neq 2014} \beta_k \times Time_{k} \times Treatment_{i} + \epsilon_{it}\]</span></p>
<p><span class="math display">\[\text{Note: The model is weighted by: Total assets 2014.}\]</span></p>
<p>Where:</p>
<ul>
<li><span class="math inline">\(\{ k = 2012, \ldots, 2017 \}\)</span></li>
<li><span class="math inline">\(Y_{it}\)</span> is Change from t-1 assets attributable to tax havens (positive), the dependent variable.</li>
<li><span class="math inline">\(Treatment_{i}\)</span> is a dummy variable that is 1 if unit <span class="math inline">\(i\)</span> receives the treatment at time <span class="math inline">\(t\)</span>, and 0 otherwise.</li>
<li><span class="math inline">\(Time_{i}\)</span> are dummy variables that are 1 if the year is <span class="math inline">\(k\)</span>, and 0 otherwise. The year 2014 is the reference year and therefore does not appear in the equation.</li>
<li><span class="math inline">\(\epsilon_{it}\)</span> is the error term.</li>
</ul>
<p><strong>Dependent variable:</strong> Change from t-1 assets attributable to tax havens (positive)</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-11-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-11-1" role="tab" aria-controls="tabset-11-1" aria-selected="true" href="">Plot</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-11-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-11-2" role="tab" aria-controls="tabset-11-2" aria-selected="false" href="">Regression table</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-11-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-11-3" role="tab" aria-controls="tabset-11-3" aria-selected="false" href="">R Code</a></li></ul>
<div class="tab-content">
<div id="tabset-11-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-11-1-tab">
<div class="cell">
<div class="cell-output-display">
<p><img src="regression_transparency_files/figure-html/unnamed-chunk-35-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</div>
<div id="tabset-11-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-11-2-tab">
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>
=========================================================================================
                             All firms           CIT &gt;= Statutory     CIT &gt; 0            
-----------------------------------------------------------------------------------------
(Intercept)                  -6699677667927.26   -18606349234386.94   -15318767029114.27 
                             (5834747193223.36)  (16160817201119.97)  (13317293066025.35)
anio_fiscal                      3346000371.80        9284671848.78        7632894018.41 
                                (2913847152.58)      (8063935092.01)      (6635403879.69)
treatment                     2285681168408.42     6305895674664.61     3217419064120.68 
                             (2105665477727.64)   (6166248183104.52)   (2957125175710.43)
anio_fiscal::2013:treatment  -2110960263589.29    -6232506272920.43    -2925115973578.74 
                             (2102348310769.40)   (6166696892439.53)   (2955327808304.05)
anio_fiscal::2015:treatment   -169916850152.85    -6102523549410.76      -14231362235.72 
                              (151955684572.65)   (6167722235681.99)    (297146959128.44)
anio_fiscal::2016:treatment   -661654533403.83    -2568598967065.85     -415141564958.01 
                              (558282993768.41)   (2704075455093.72)    (412013046032.11)
anio_fiscal::2017:treatment   -597296976235.53    -3266056227040.42     -841559229204.79 
                              (487196538996.39)   (3244727781645.94)    (694517424839.85)
anio_fiscal::2018:treatment   -566690044102.61    -3714330419837.59     -774092195495.48 
                              (457019658568.44)   (3633504156808.34)    (634253838742.06)
anio_fiscal::2019:treatment   -546968996904.73    -1341995515091.95     -145464480798.30 
                              (425558175950.09)   (1627636213265.47)    (419816293747.06)
-----------------------------------------------------------------------------------------
r.squared                                 0.00                 0.01                 0.01 
adj.r.squared                             0.00                 0.01                 0.01 
sigma                        24484053586254.04    37154400109942.84    29905107192737.56 
logLik                              -554931.89           -226919.47           -373653.74 
AIC                                 1109881.78            453856.93            747325.48 
BIC                                 1109951.94            453918.92            747392.02 
nobs                                  17952                 7243                12010    
=========================================================================================
*** p &lt; 0.001; ** p &lt; 0.01; * p &lt; 0.05</code></pre>
</div>
</div>
</div>
<div id="tabset-11-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-11-3-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="co"># With this code we construct our formula as a string to use in the model function.</span></span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Check above to see the label of the dependent variable.</span></span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a>fml_event_study <span class="ot">&lt;-</span> glue<span class="sc">::</span><span class="fu">glue</span>(<span class="st">'{dependent} ~  anio_fiscal + treatment + i(anio_fiscal,treatment, ref = 2014)'</span>) <span class="sc">%&gt;%</span></span>
<span id="cb23-5"><a href="#cb23-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">formula</span>(.)</span>
<span id="cb23-6"><a href="#cb23-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-7"><a href="#cb23-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Model estimation:</span></span>
<span id="cb23-8"><a href="#cb23-8" aria-hidden="true" tabindex="-1"></a>es_model_aw <span class="ot">&lt;-</span> <span class="fu">feols</span>(<span class="at">data =</span> rtable,</span>
<span id="cb23-9"><a href="#cb23-9" aria-hidden="true" tabindex="-1"></a>                     <span class="at">fml =</span> fml_event_study,</span>
<span id="cb23-10"><a href="#cb23-10" aria-hidden="true" tabindex="-1"></a>                  <span class="at">weights =</span> <span class="sc">~</span>assets_2014,</span>
<span id="cb23-11"><a href="#cb23-11" aria-hidden="true" tabindex="-1"></a>                  <span class="at">cluster =</span> <span class="sc">~</span>firm_id)</span>
<span id="cb23-12"><a href="#cb23-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Wald test using clustered matrix of variance/covariance:</span></span>
<span id="cb23-13"><a href="#cb23-13" aria-hidden="true" tabindex="-1"></a>vcov_cl <span class="ot">&lt;-</span> <span class="fu">vcovCL</span>(<span class="at">x =</span> es_model_aw,</span>
<span id="cb23-14"><a href="#cb23-14" aria-hidden="true" tabindex="-1"></a>                  <span class="at">cluster =</span> rtable<span class="sc">$</span>firm_id)</span>
<span id="cb23-15"><a href="#cb23-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-16"><a href="#cb23-16" aria-hidden="true" tabindex="-1"></a><span class="co"># Adjusted standard errors:</span></span>
<span id="cb23-17"><a href="#cb23-17" aria-hidden="true" tabindex="-1"></a>model_corrected <span class="ot">&lt;-</span> <span class="fu">coeftest</span>(<span class="at">vcov. =</span> vcov_cl,</span>
<span id="cb23-18"><a href="#cb23-18" aria-hidden="true" tabindex="-1"></a>                            <span class="at">x =</span> did_model_fe) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
</div>
</section>
<section id="event-study-design-assets-weighted-with-fixed-effects-1" class="level2" data-number="2.4">
<h2 data-number="2.4" class="anchored" data-anchor-id="event-study-design-assets-weighted-with-fixed-effects-1"><span class="header-section-number">2.4</span> Event Study design assets weighted (with fixed effects)</h2>
<p><span class="math display">\[Y_{it} = \beta_0 + \beta_1 \times Treatment_{i} + \beta_2 \times Post_{t} + \sum_{k \neq 2014} \beta_k \times Time_{k} \times Treatment_{i} + \alpha_i + \gamma_t + \epsilon_{it}\]</span></p>
<p><span class="math display">\[\text{Note: The model is weighted by: Total assets 2014.}\]</span></p>
<p>Where:</p>
<ul>
<li><span class="math inline">\(\{ k = 2012, \ldots, 2017 \}\)</span></li>
<li><span class="math inline">\(Y_{it}\)</span> is Change from t-1 assets attributable to tax havens (positive), the dependent variable.</li>
<li><span class="math inline">\(Treatment_{i}\)</span> is a dummy variable that is 1 if unit <span class="math inline">\(i\)</span> receives the treatment at time <span class="math inline">\(t\)</span>, and 0 otherwise.</li>
<li><span class="math inline">\(Time_{i}\)</span> are dummy variables that are 1 if the year is <span class="math inline">\(k\)</span>, and 0 otherwise. The year 2014 is the reference year and therefore does not appear in the equation.</li>
<li><span class="math inline">\(alpha_i\)</span> are the fixed effects at firm level</li>
<li><span class="math inline">\(gamma_t\)</span> are the fixed effects at time</li>
<li><span class="math inline">\(\epsilon_{it}\)</span> is the error term.</li>
</ul>
<p><strong>Dependent variable:</strong> Change from t-1 assets attributable to tax havens (positive)</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-12-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-12-1" role="tab" aria-controls="tabset-12-1" aria-selected="true" href="">Plot</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-12-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-12-2" role="tab" aria-controls="tabset-12-2" aria-selected="false" href="">Regression table</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-12-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-12-3" role="tab" aria-controls="tabset-12-3" aria-selected="false" href="">R Code</a></li></ul>
<div class="tab-content">
<div id="tabset-12-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-12-1-tab">
<div class="cell">
<div class="cell-output-display">
<p><img src="regression_transparency_files/figure-html/unnamed-chunk-38-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</div>
<div id="tabset-12-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-12-2-tab">
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>
=======================================================================================
                             All firms           CIT &gt;= Statutory    CIT &gt; 0           
---------------------------------------------------------------------------------------
anio_fiscal::2013:treatment  -2318832823515.41    -321083673602.44   -3902140261330.05 
                             (2311121250713.76)   (621382306202.98)  (3880365321685.19)
anio_fiscal::2015:treatment   -303236748827.04    -411381151200.14    -546572588665.84 
                              (258686960045.41)   (683482299483.58)   (481648612203.64)
anio_fiscal::2016:treatment   -428786341054.51   -1708424139641.45    -613985141754.01 
                              (267948905765.78)  (1202201089401.29)   (435539470498.15)
anio_fiscal::2017:treatment    100507328802.94    -611047611251.38      49567719358.78 
                              (222418872694.55)   (824805718886.41)   (265303143367.29)
anio_fiscal::2018:treatment    143874571624.75    -773083398521.34     149510340345.06 
                              (262559229719.21)   (750898716314.61)   (343918696347.28)
anio_fiscal::2019:treatment    389509359856.61    -113518925820.06     595797460931.98 
                              (511755727608.60)   (181198406001.53)   (894143521741.01)
---------------------------------------------------------------------------------------
r.squared                                 0.49                0.59                0.50 
adj.r.squared                             0.36                0.33                0.33 
sigma                        19563580999903.12   30542305145350.31   24571397775229.30 
logLik                              -549039.18          -223817.94          -369574.54 
AIC                                 1105260.37           453197.89           745407.07 
BIC                                 1133253.86           472352.83           768541.32 
nobs                                  17952                7243               12010    
within.r.squared                          0.00                0.00                0.00 
=======================================================================================
*** p &lt; 0.001; ** p &lt; 0.01; * p &lt; 0.05</code></pre>
</div>
</div>
</div>
<div id="tabset-12-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-12-3-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="co"># With this code we construct our formula as a string to use in the model function.</span></span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Check above to see the label of the dependent variable.</span></span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-4"><a href="#cb25-4" aria-hidden="true" tabindex="-1"></a>  fml_event_study_fe <span class="ot">&lt;-</span> glue<span class="sc">::</span><span class="fu">glue</span>(<span class="st">'{dependent} ~  i(anio_fiscal,treatment, ref = 2014) | firm_id + anio_fiscal'</span>) <span class="sc">%&gt;%</span></span>
<span id="cb25-5"><a href="#cb25-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">formula</span>(.)</span>
<span id="cb25-6"><a href="#cb25-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-7"><a href="#cb25-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Model estimation:</span></span>
<span id="cb25-8"><a href="#cb25-8" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb25-9"><a href="#cb25-9" aria-hidden="true" tabindex="-1"></a>es_model_aw_fe <span class="ot">&lt;-</span> <span class="fu">feols</span>(<span class="at">data =</span> rtable,</span>
<span id="cb25-10"><a href="#cb25-10" aria-hidden="true" tabindex="-1"></a>                        <span class="at">fml =</span> fml_event_study_fe,</span>
<span id="cb25-11"><a href="#cb25-11" aria-hidden="true" tabindex="-1"></a>                        <span class="at">weights =</span> <span class="sc">~</span>assets_2014,</span>
<span id="cb25-12"><a href="#cb25-12" aria-hidden="true" tabindex="-1"></a>                        <span class="at">cluster =</span> <span class="sc">~</span>firm_id)</span>
<span id="cb25-13"><a href="#cb25-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-14"><a href="#cb25-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Wald test using clustered matrix of variance/covariance:</span></span>
<span id="cb25-15"><a href="#cb25-15" aria-hidden="true" tabindex="-1"></a>vcov_cl <span class="ot">&lt;-</span> <span class="fu">vcovCL</span>(<span class="at">x =</span> es_model_aw_fe,</span>
<span id="cb25-16"><a href="#cb25-16" aria-hidden="true" tabindex="-1"></a>                  <span class="at">cluster =</span> rtable<span class="sc">$</span>firm_id)</span>
<span id="cb25-17"><a href="#cb25-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-18"><a href="#cb25-18" aria-hidden="true" tabindex="-1"></a><span class="co"># Adjusted standard errors:</span></span>
<span id="cb25-19"><a href="#cb25-19" aria-hidden="true" tabindex="-1"></a>model_corrected <span class="ot">&lt;-</span> <span class="fu">coeftest</span>(<span class="at">vcov. =</span> vcov_cl,</span>
<span id="cb25-20"><a href="#cb25-20" aria-hidden="true" tabindex="-1"></a>                            <span class="at">x =</span> did_model_fe) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
</div>
</section>
<section id="diff-in-diff-design-unsaturated-model-1" class="level2" data-number="2.5">
<h2 data-number="2.5" class="anchored" data-anchor-id="diff-in-diff-design-unsaturated-model-1"><span class="header-section-number">2.5</span> Diff-in-diff design (unsaturated model)</h2>
<p><span class="math display">\[Y_{it} = \beta_0 \times Treatment_{i} + \beta_1 \times Post_{t} + \beta_2 \times Treatment_{i} \times Post_{t} + \epsilon_{it}\]</span></p>
<p>Where:</p>
<ul>
<li><span class="math inline">\(Y_{it}\)</span> is Change from t-1 assets attributable to tax havens (positive), the dependent variable for unit <span class="math inline">\(i\)</span> at time <span class="math inline">\(t\)</span>.</li>
<li><span class="math inline">\(Treatment_{i}\)</span> is a dummy variable that is 1 if unit <span class="math inline">\(i\)</span> receives the treatment at time <span class="math inline">\(t\)</span>, and 0 otherwise.</li>
<li><span class="math inline">\(Post_{t}\)</span> is a dummy variable that is 1 if time <span class="math inline">\(t\)</span> is after the implementation of the treatment, and 0 otherwise.</li>
<li><span class="math inline">\(Treatment_{i} \times Post_{t}\)</span> is the interaction between the treatment and the post period, which captures the treatment effect in the difference-in-differences.</li>
</ul>
<p><strong>Dependent variable:</strong> Change from t-1 assets attributable to tax havens (positive)</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-13-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-13-1" role="tab" aria-controls="tabset-13-1" aria-selected="true" href="">Plot</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-13-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-13-2" role="tab" aria-controls="tabset-13-2" aria-selected="false" href="">Regression table</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-13-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-13-3" role="tab" aria-controls="tabset-13-3" aria-selected="false" href="">R Code</a></li></ul>
<div class="tab-content">
<div id="tabset-13-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-13-1-tab">
<div class="cell">
<div class="cell-output-display">
<p><img src="regression_transparency_files/figure-html/unnamed-chunk-41-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</div>
<div id="tabset-13-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-13-2-tab">
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>
===============================================================================================================================
                    All firms                           CIT &gt;= Statutory                     CIT &gt; 0                           
-------------------------------------------------------------------------------------------------------------------------------
(Intercept)                               79686044.68                            73590.39 *                       105791329.25 
                                         (79373677.83)                          (36276.34)                       (105663926.25)
treatment                            1237108912640.21                    3204941215358.15                     1862916548164.52 
                                    (1047472817804.27)                  (3065207303134.29)                   (1571826367181.72)
postPost                               60484049220.38                     152238843749.27                       95331538674.93 
                                      (53051577122.70)                   (133355233625.06)                     (83600826751.62)
treatment:postPost                    489849305784.62                    -279203959418.55                      856801708380.84 
                                     (666221705753.69)                   (443206788918.50)                   (1121062613495.76)
-------------------------------------------------------------------------------------------------------------------------------
r.squared                                        0.00                                0.01                                 0.01 
adj.r.squared                                    0.00                                0.00                                 0.00 
sigma                                6438659124748.59                    9785239451444.46                     7864369120228.33 
statistic                                       19.14                               12.54                                20.19 
p.value                                          0.00                                0.00                                 0.00 
df                                               3                                   3                                    3    
logLik                                     -554935.25                          -226927.24                           -373656.75 
AIC                                        1109880.50                           453864.47                            747323.49 
BIC                                        1109919.48                           453898.91                            747360.46 
deviance            744058234615863178964884062462      693140845612918151124888842688       742550709720366034722204086222    
df.residual                                  17948                                7239                                12006    
nobs                                         17952                                7243                                12010    
===============================================================================================================================
*** p &lt; 0.001; ** p &lt; 0.01; * p &lt; 0.05</code></pre>
</div>
</div>
</div>
<div id="tabset-13-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-13-3-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="co"># With this code we construct our formula as a string to use in the model function.</span></span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Check above to see the label of the dependent variable.</span></span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a>fml <span class="ot">&lt;-</span> glue<span class="sc">::</span><span class="fu">glue</span>(<span class="st">'dependent_variable ~ treatment + post + treatment:post'</span>)<span class="sc">%&gt;%</span> </span>
<span id="cb27-5"><a href="#cb27-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">formula</span>(.)</span>
<span id="cb27-6"><a href="#cb27-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-7"><a href="#cb27-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Model estimation:</span></span>
<span id="cb27-8"><a href="#cb27-8" aria-hidden="true" tabindex="-1"></a>did_model <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="at">data =</span> rtable,</span>
<span id="cb27-9"><a href="#cb27-9" aria-hidden="true" tabindex="-1"></a>                  <span class="at">formula =</span> fml)</span>
<span id="cb27-10"><a href="#cb27-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-11"><a href="#cb27-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Wald test using clustered matrix of variance/covariance:</span></span>
<span id="cb27-12"><a href="#cb27-12" aria-hidden="true" tabindex="-1"></a>vcov_cl <span class="ot">&lt;-</span> <span class="fu">vcovCL</span>(<span class="at">x =</span> did_model,</span>
<span id="cb27-13"><a href="#cb27-13" aria-hidden="true" tabindex="-1"></a>                  <span class="at">cluster =</span> rtable<span class="sc">$</span>firm_id)</span>
<span id="cb27-14"><a href="#cb27-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-15"><a href="#cb27-15" aria-hidden="true" tabindex="-1"></a><span class="co"># Adjusted standard errors:</span></span>
<span id="cb27-16"><a href="#cb27-16" aria-hidden="true" tabindex="-1"></a>model_corrected <span class="ot">&lt;-</span> <span class="fu">coeftest</span>(<span class="at">vcov. =</span> vcov_cl,</span>
<span id="cb27-17"><a href="#cb27-17" aria-hidden="true" tabindex="-1"></a>                            <span class="at">x =</span> did_model) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
</div>
</section>
<section id="diff-in-diff-design-with-fixed-effects-1" class="level2" data-number="2.6">
<h2 data-number="2.6" class="anchored" data-anchor-id="diff-in-diff-design-with-fixed-effects-1"><span class="header-section-number">2.6</span> Diff-in-diff design (with fixed effects)</h2>
<p><span class="math display">\[Y_{it} = \beta_0 + \beta_1 \times Treatment_{i} + \beta_2 \times Post_{t} + \beta_3 \times Treatment_{i} \times Post_{t} + \alpha_i + \gamma_t + \epsilon_{it}\]</span></p>
<p>Where:</p>
<ul>
<li><span class="math inline">\(Y_{it}\)</span> is Change from t-1 assets attributable to tax havens (positive), the dependent variable for unit <span class="math inline">\(i\)</span> at time <span class="math inline">\(t\)</span>.</li>
<li><span class="math inline">\(Treatment_{i}\)</span> is a dummy variable that is 1 if unit <span class="math inline">\(i\)</span> receives the treatment at time <span class="math inline">\(t\)</span>, and 0 otherwise.</li>
<li><span class="math inline">\(Post_{t}\)</span> is a dummy variable that is 1 if time <span class="math inline">\(t\)</span> is after the implementation of the treatment, and 0 otherwise.</li>
<li><span class="math inline">\(Treatment_{i} \times Post_{t}\)</span> is the interaction between the treatment and the post period, which captures the treatment effect in the difference-in-differences.</li>
<li><span class="math inline">\(\alpha_i\)</span> is the fixed effect for unit <span class="math inline">\(i\)</span>, which captures time-invariant characteristics of each unit.</li>
<li><span class="math inline">\(\gamma_t\)</span> is the fixed effect for time <span class="math inline">\(t\)</span>, which captures any time shock that affects all units in the same way.</li>
<li><span class="math inline">\(\epsilon_{it}\)</span> is the error term.</li>
</ul>
<p><strong>Dependent variable:</strong> Change from t-1 assets attributable to tax havens (positive)</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-14-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-14-1" role="tab" aria-controls="tabset-14-1" aria-selected="true" href="">Plot</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-14-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-14-2" role="tab" aria-controls="tabset-14-2" aria-selected="false" href="">Regression table</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-14-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-14-3" role="tab" aria-controls="tabset-14-3" aria-selected="false" href="">R Code</a></li></ul>
<div class="tab-content">
<div id="tabset-14-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-14-1-tab">
<div class="cell">
<div class="cell-output-display">
<p><img src="regression_transparency_files/figure-html/unnamed-chunk-44-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</div>
<div id="tabset-14-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-14-2-tab">
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>
==============================================================================================================================
                    All firms                           CIT &gt;= Statutory                    CIT &gt; 0                           
------------------------------------------------------------------------------------------------------------------------------
postPost                               63296140618.96                     179753642164.07                     114802940152.50 
                                      (55515955480.18)                   (163731807321.40)                   (102327404501.49)
treatment:postPost                   1033755812779.72                    -624667926802.60                    1702024055303.17 
                                    (1167434576654.92)                   (482989910090.41)                  (1925245200926.94)
------------------------------------------------------------------------------------------------------------------------------
r.squared                                        0.00                                0.00                                0.00 
adj.r.squared                                   -0.25                               -0.62                               -0.35 
statistic                                        3.15                                0.29                                3.37 
p.value                                          0.04                                0.75                                0.03 
deviance            386258418606358003522860242048      294213460256653766464882828802      377079585476290862368646688860    
df.residual                                  14371                                4472                                8891    
nobs                                         17952                                7243                               12010    
==============================================================================================================================
*** p &lt; 0.001; ** p &lt; 0.01; * p &lt; 0.05</code></pre>
</div>
</div>
</div>
<div id="tabset-14-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-14-3-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="co"># With this code we construct our formula as a string to use in the model function.</span></span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Check above to see the label of the dependent variable.</span></span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-4"><a href="#cb29-4" aria-hidden="true" tabindex="-1"></a>fml <span class="ot">&lt;-</span> glue<span class="sc">::</span><span class="fu">glue</span>(<span class="st">'dependent_variable ~ treatment + post + treatment:post'</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb29-5"><a href="#cb29-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">formula</span>(.)</span>
<span id="cb29-6"><a href="#cb29-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-7"><a href="#cb29-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Model estimation:</span></span>
<span id="cb29-8"><a href="#cb29-8" aria-hidden="true" tabindex="-1"></a>did_model_fe <span class="ot">&lt;-</span> <span class="fu">plm</span>(<span class="at">data =</span> rtable,</span>
<span id="cb29-9"><a href="#cb29-9" aria-hidden="true" tabindex="-1"></a>                    <span class="at">formula =</span> fml,</span>
<span id="cb29-10"><a href="#cb29-10" aria-hidden="true" tabindex="-1"></a>                    <span class="at">index =</span> <span class="fu">c</span>(<span class="st">"firm_id"</span>,<span class="st">"anio_fiscal"</span>),</span>
<span id="cb29-11"><a href="#cb29-11" aria-hidden="true" tabindex="-1"></a>                    <span class="at">model =</span> <span class="st">"within"</span>)</span>
<span id="cb29-12"><a href="#cb29-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-13"><a href="#cb29-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Wald test using clustered matrix of variance/covariance:</span></span>
<span id="cb29-14"><a href="#cb29-14" aria-hidden="true" tabindex="-1"></a>vcov_cl <span class="ot">&lt;-</span> <span class="fu">vcovCL</span>(<span class="at">x =</span> did_model_fe,</span>
<span id="cb29-15"><a href="#cb29-15" aria-hidden="true" tabindex="-1"></a>                  <span class="at">cluster =</span> rtable<span class="sc">$</span>firm_id)</span>
<span id="cb29-16"><a href="#cb29-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-17"><a href="#cb29-17" aria-hidden="true" tabindex="-1"></a><span class="co"># Adjusted standard errors:</span></span>
<span id="cb29-18"><a href="#cb29-18" aria-hidden="true" tabindex="-1"></a>model_corrected <span class="ot">&lt;-</span> <span class="fu">coeftest</span>(<span class="at">vcov. =</span> vcov_cl,</span>
<span id="cb29-19"><a href="#cb29-19" aria-hidden="true" tabindex="-1"></a>                            <span class="at">x =</span> did_model_fe) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
</div>
</section>
<section id="diff-in-diff-design-assets-weighted-unsaturated-model-1" class="level2" data-number="2.7">
<h2 data-number="2.7" class="anchored" data-anchor-id="diff-in-diff-design-assets-weighted-unsaturated-model-1"><span class="header-section-number">2.7</span> Diff-in-diff design assets weighted (unsaturated model)</h2>
<p><span class="math display">\[Y_{it} = \beta_0 \times Treatment_{i} + \beta_1 \times Post_{t} + \beta_2 \times Treatment_{i} \times Post_{t} + \epsilon_{it}\]</span> <span class="math display">\[\text{Note: The model is weighted by: Total assets 2014.}\]</span></p>
<p>Where:</p>
<ul>
<li><span class="math inline">\(Y_{it}\)</span> is Change from t-1 assets attributable to tax havens (positive), the dependent variable for unit <span class="math inline">\(i\)</span> at time <span class="math inline">\(t\)</span>.</li>
<li><span class="math inline">\(Treatment_{i}\)</span> is a dummy variable that is 1 if unit <span class="math inline">\(i\)</span> receives the treatment at time <span class="math inline">\(t\)</span>, and 0 otherwise.</li>
<li><span class="math inline">\(Post_{t}\)</span> is a dummy variable that is 1 if time <span class="math inline">\(t\)</span> is after the implementation of the treatment, and 0 otherwise.</li>
<li><span class="math inline">\(Treatment_{i} \times Post_{t}\)</span> is the interaction between the treatment and the post period, which captures the treatment effect in the difference-in-differences.</li>
</ul>
<p><strong>Dependent variable:</strong> Change from t-1 assets attributable to tax havens (positive)</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-15-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-15-1" role="tab" aria-controls="tabset-15-1" aria-selected="true" href="">Plot</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-15-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-15-2" role="tab" aria-controls="tabset-15-2" aria-selected="false" href="">Regression table</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-15-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-15-3" role="tab" aria-controls="tabset-15-3" aria-selected="false" href="">R Code</a></li></ul>
<div class="tab-content">
<div id="tabset-15-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-15-1-tab">
<div class="cell">
<div class="cell-output-display">
<p><img src="regression_transparency_files/figure-html/unnamed-chunk-47-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</div>
<div id="tabset-15-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-15-2-tab">
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>
======================================================================================================================================
                    All firms                             CIT &gt;= Statutory                        CIT &gt; 0                             
--------------------------------------------------------------------------------------------------------------------------------------
(Intercept)                                105031525.77                              89957.20 **                         137975370.99 
                                          (104643957.49)                            (31526.54)                          (137803651.87)
treatment                              1274556218313.65                      3283191064288.66                        1912411218712.65 
                                      (1065555476363.60)                    (3116775034247.73)                      (1593000388198.28)
postPost                                 64602211380.33                       156818845725.32                          99913936189.89 
                                        (55935744190.50)                     (135562086942.65)                        (86491056307.96)
treatment:postPost                      470085163224.40                      -399412973013.17                         808449818450.89 
                                       (665907243173.91)                     (494558271389.95)                      (1100540646288.67)
--------------------------------------------------------------------------------------------------------------------------------------
r.squared                                          0.00                                  0.01                                    0.01 
adj.r.squared                                      0.00                                  0.00                                    0.00 
sigma                                 24485393772016.24                     37181823928559.61                       29906714832441.32 
statistic                                         19.80                                 12.74                                   20.71 
p.value                                            0.00                                  0.00                                    0.00 
df                                                 3                                     3                                       3    
logLik                                       -555670.76                            -227116.22                              -374056.67 
AIC                                          1111351.52                             454242.44                               748123.34 
BIC                                          1111390.50                             454276.87                               748160.31 
deviance            10760445352647579582484042226066      10007830853907259931284682420820        10738305574379997759228426428608    
df.residual                                    17948                                  7239                                   12006    
nobs                                           17952                                  7243                                   12010    
======================================================================================================================================
*** p &lt; 0.001; ** p &lt; 0.01; * p &lt; 0.05</code></pre>
</div>
</div>
</div>
<div id="tabset-15-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-15-3-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="co"># With this code we construct our formula as a string to use in the model function.</span></span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Check above to see the label of the dependent variable.</span></span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-4"><a href="#cb31-4" aria-hidden="true" tabindex="-1"></a>fml <span class="ot">&lt;-</span> glue<span class="sc">::</span><span class="fu">glue</span>(<span class="st">'dependent_variable ~ treatment + post + treatment:post'</span>)<span class="sc">%&gt;%</span> </span>
<span id="cb31-5"><a href="#cb31-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">formula</span>(.)</span>
<span id="cb31-6"><a href="#cb31-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-7"><a href="#cb31-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Model estimation:</span></span>
<span id="cb31-8"><a href="#cb31-8" aria-hidden="true" tabindex="-1"></a>did_model_aw <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="at">data =</span> rtable,</span>
<span id="cb31-9"><a href="#cb31-9" aria-hidden="true" tabindex="-1"></a>                   <span class="at">formula =</span> fml,</span>
<span id="cb31-10"><a href="#cb31-10" aria-hidden="true" tabindex="-1"></a>                   <span class="at">weights =</span> assets_2014)</span>
<span id="cb31-11"><a href="#cb31-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-12"><a href="#cb31-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Wald test using clustered matrix of variance/covariance:</span></span>
<span id="cb31-13"><a href="#cb31-13" aria-hidden="true" tabindex="-1"></a>vcov_cl <span class="ot">&lt;-</span> <span class="fu">vcovCL</span>(<span class="at">x =</span> did_model,</span>
<span id="cb31-14"><a href="#cb31-14" aria-hidden="true" tabindex="-1"></a>                  <span class="at">cluster =</span> rtable<span class="sc">$</span>firm_id)</span>
<span id="cb31-15"><a href="#cb31-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-16"><a href="#cb31-16" aria-hidden="true" tabindex="-1"></a><span class="co"># Adjusted standard errors:</span></span>
<span id="cb31-17"><a href="#cb31-17" aria-hidden="true" tabindex="-1"></a>model_corrected <span class="ot">&lt;-</span> <span class="fu">coeftest</span>(<span class="at">vcov. =</span> vcov_cl,</span>
<span id="cb31-18"><a href="#cb31-18" aria-hidden="true" tabindex="-1"></a>                            <span class="at">x =</span> did_model) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
</div>
</section>
<section id="diff-in-diff-design-assets-weighted-with-fixed-effects-1" class="level2" data-number="2.8">
<h2 data-number="2.8" class="anchored" data-anchor-id="diff-in-diff-design-assets-weighted-with-fixed-effects-1"><span class="header-section-number">2.8</span> Diff-in-diff design assets weighted (with fixed effects)</h2>
<p><span class="math display">\[Y_{it} = \beta_0 + \beta_1 \times Treatment_{i} + \beta_2 \times Post_{t} + \beta_3 \times Treatment_{i} \times Post_{t} + \alpha_i + \gamma_t + \epsilon_{it}\]</span></p>
<p><span class="math display">\[\text{Note: The model is weighted by: Total assets 2014.}\]</span></p>
<p>Where:</p>
<ul>
<li><span class="math inline">\(Y_{it}\)</span> is Change from t-1 assets attributable to tax havens (positive), the dependent variable for unit <span class="math inline">\(i\)</span> at time <span class="math inline">\(t\)</span>.</li>
<li><span class="math inline">\(Treatment_{i}\)</span> is a dummy variable that is 1 if unit <span class="math inline">\(i\)</span> receives the treatment at time <span class="math inline">\(t\)</span>, and 0 otherwise.</li>
<li><span class="math inline">\(Post_{t}\)</span> is a dummy variable that is 1 if time <span class="math inline">\(t\)</span> is after the implementation of the treatment, and 0 otherwise.</li>
<li><span class="math inline">\(Treatment_{i} \times Post_{t}\)</span> is the interaction between the treatment and the post period, which captures the treatment effect in the difference-in-differences.</li>
<li><span class="math inline">\(\alpha_i\)</span> is the fixed effect for unit <span class="math inline">\(i\)</span>, which captures time-invariant characteristics of each unit.</li>
<li><span class="math inline">\(\gamma_t\)</span> is the fixed effect for time <span class="math inline">\(t\)</span>, which captures any time shock that affects all units in the same way.</li>
<li><span class="math inline">\(\epsilon_{it}\)</span> is the error term.</li>
</ul>
<p><strong>Dependent variable:</strong> Change from t-1 assets attributable to tax havens (positive)</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-16-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-16-1" role="tab" aria-controls="tabset-16-1" aria-selected="true" href="">Plot</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-16-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-16-2" role="tab" aria-controls="tabset-16-2" aria-selected="false" href="">Regression table</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-16-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-16-3" role="tab" aria-controls="tabset-16-3" aria-selected="false" href="">R Code</a></li></ul>
<div class="tab-content">
<div id="tabset-16-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-16-1-tab">
<div class="cell">
<div class="cell-output-display">
<p><img src="regression_transparency_files/figure-html/unnamed-chunk-50-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</div>
<div id="tabset-16-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-16-2-tab">
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>
==============================================================================
                    All firms           CIT &gt;= Statutory    CIT &gt; 0           
------------------------------------------------------------------------------
treatment:postPost   1010537280237.46    -622999111212.49    1677586849085.61 
                    (1164242866780.68)   (480044938085.51)  (1904819161682.72)
------------------------------------------------------------------------------
r.squared                        0.49                0.59                0.50 
adj.r.squared                    0.36                0.33                0.33 
sigma               19569089573943.22   30528473880313.41   24583481172056.41 
logLik                     -549046.97          -223818.66          -369583.49 
AIC                        1105265.93           453189.33           745414.97 
BIC                        1133220.44           472309.83           768512.25 
nobs                         17952                7243               12010    
within.r.squared                 0.00                0.00                0.00 
==============================================================================
*** p &lt; 0.001; ** p &lt; 0.01; * p &lt; 0.05</code></pre>
</div>
</div>
</div>
<div id="tabset-16-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-16-3-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="co"># With this code we construct our formula as a string to use in the model function.</span></span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Check above to see the label of the dependent variable.</span></span>
<span id="cb33-3"><a href="#cb33-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-4"><a href="#cb33-4" aria-hidden="true" tabindex="-1"></a>fml <span class="ot">&lt;-</span> glue<span class="sc">::</span><span class="fu">glue</span>(<span class="st">'dependent_variable ~ treatment + post + treatment:post'</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb33-5"><a href="#cb33-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">formula</span>(.)</span>
<span id="cb33-6"><a href="#cb33-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-7"><a href="#cb33-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Model estimation:</span></span>
<span id="cb33-8"><a href="#cb33-8" aria-hidden="true" tabindex="-1"></a>did_model_fe_aw <span class="ot">&lt;-</span> <span class="fu">feols</span>(<span class="at">data =</span> rtable,</span>
<span id="cb33-9"><a href="#cb33-9" aria-hidden="true" tabindex="-1"></a>                         <span class="at">fml =</span> fml_fe,</span>
<span id="cb33-10"><a href="#cb33-10" aria-hidden="true" tabindex="-1"></a>                         <span class="at">weights =</span> <span class="sc">~</span>assets_2014,</span>
<span id="cb33-11"><a href="#cb33-11" aria-hidden="true" tabindex="-1"></a>                         <span class="at">cluster =</span> <span class="sc">~</span>firm_id)</span>
<span id="cb33-12"><a href="#cb33-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-13"><a href="#cb33-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Wald test using clustered matrix of variance/covariance:</span></span>
<span id="cb33-14"><a href="#cb33-14" aria-hidden="true" tabindex="-1"></a>vcov_cl <span class="ot">&lt;-</span> <span class="fu">vcovCL</span>(<span class="at">x =</span> did_model_fe,</span>
<span id="cb33-15"><a href="#cb33-15" aria-hidden="true" tabindex="-1"></a>                  <span class="at">cluster =</span> rtable<span class="sc">$</span>firm_id)</span>
<span id="cb33-16"><a href="#cb33-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-17"><a href="#cb33-17" aria-hidden="true" tabindex="-1"></a><span class="co"># Adjusted standard errors:</span></span>
<span id="cb33-18"><a href="#cb33-18" aria-hidden="true" tabindex="-1"></a>model_corrected <span class="ot">&lt;-</span> <span class="fu">coeftest</span>(<span class="at">vcov. =</span> vcov_cl,</span>
<span id="cb33-19"><a href="#cb33-19" aria-hidden="true" tabindex="-1"></a>                            <span class="at">x =</span> did_model_fe) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
</div>
</section>
</section>
<section id="minor-groups-t-min-vs-c-min" class="level1" data-number="3">
<h1 data-number="3"><span class="header-section-number">3</span> Minor groups (T-Min vs C-Min)</h1>
<section id="event-study-design-unsaturated-model-2" class="level2" data-number="3.1">
<h2 data-number="3.1" class="anchored" data-anchor-id="event-study-design-unsaturated-model-2"><span class="header-section-number">3.1</span> Event Study design (unsaturated model)</h2>
<p><span class="math display">\[Y_{it} = \beta_0 + \beta_1 \times Treatment_{i} + \beta_2 \times Post_{t} + \sum_{k \neq 2014} \beta_k \times Time_{k} \times Treatment_{i} + \epsilon_{it}\]</span></p>
<p>Where:</p>
<ul>
<li><span class="math inline">\(\{ k = 2012, \ldots, 2017 \}\)</span></li>
<li><span class="math inline">\(Y_{it}\)</span> is Change from t-1 assets attributable to tax havens (positive), the dependent variable.</li>
<li><span class="math inline">\(Treatment_{i}\)</span> is a dummy variable that is 1 if unit <span class="math inline">\(i\)</span> receives the treatment at time <span class="math inline">\(t\)</span>, and 0 otherwise.</li>
<li><span class="math inline">\(Time_{i}\)</span> are dummy variables that are 1 if the year is <span class="math inline">\(k\)</span>, and 0 otherwise. The year 2014 is the reference year and therefore does not appear in the equation.</li>
<li><span class="math inline">\(\epsilon_{it}\)</span> is the error term.</li>
</ul>
<p><strong>Dependent variable:</strong> Change from t-1 assets attributable to tax havens (positive)</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-17-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-17-1" role="tab" aria-controls="tabset-17-1" aria-selected="true" href="">Plot</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-17-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-17-2" role="tab" aria-controls="tabset-17-2" aria-selected="false" href="">Regression table</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-17-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-17-3" role="tab" aria-controls="tabset-17-3" aria-selected="false" href="">R Code</a></li></ul>
<div class="tab-content">
<div id="tabset-17-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-17-1-tab">
<div class="cell">
<div class="cell-output-display">
<p><img src="regression_transparency_files/figure-html/unnamed-chunk-54-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</div>
<div id="tabset-17-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-17-2-tab">
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>
======================================================================================================================================
                                           All firms                      CIT &gt;= Statutory               CIT &gt; 0                      
--------------------------------------------------------------------------------------------------------------------------------------
(Intercept)                                                -94679158.81                  -236605833.14                  -115711028.06 
                                                          (109762288.13)                 (235267610.67)                 (135117153.00)
anio_fiscal                                                    47040.29                      117502.57                       57493.97 
                                                              (54478.10)                    (116754.80)                     (66971.87)
treatment                                                  835476904.69                  1136300094.99                   592893694.36 
                                                          (576758639.73)                (1088619917.47)                 (565919386.16)
i(anio_fiscal, treatment, ref = 2014)2013                 2263710073.00                  6267880682.19                  3252716938.19 
                                                         (2614507764.39)                (6184730040.90)                (3212935823.79)
i(anio_fiscal, treatment, ref = 2014)2015                 -802275294.35                 -1093552220.82                  -555828664.55 
                                                          (577150011.79)                (1089291913.88)                 (566310267.20)
i(anio_fiscal, treatment, ref = 2014)2016                14274713911.96                 23516940679.24                 20156905440.77 
                                                        (14031049857.89)               (24506800487.00)               (19233635066.37)
i(anio_fiscal, treatment, ref = 2014)2017                 -806566176.35                 -1094316706.22                  -557049755.84 
                                                          (575498546.26)                (1085987200.35)                 (563774409.00)
i(anio_fiscal, treatment, ref = 2014)2018                 -575444966.23                  -749553996.91                  -227762536.31 
                                                          (635315628.46)                (1156166689.57)                 (676340009.03)
i(anio_fiscal, treatment, ref = 2014)2019                 -511855850.88                  -530349398.61                  -153111224.16 
                                                          (664899291.70)                (1248526314.00)                 (720504756.33)
--------------------------------------------------------------------------------------------------------------------------------------
r.squared                                                          0.01                           0.02                           0.01 
adj.r.squared                                                      0.01                           0.01                           0.01 
sigma                                                    20748037402.66                 31907513474.61                 24636442343.75 
statistic                                                          7.65                           4.95                           7.40 
p.value                                                            0.00                           0.00                           0.00 
df                                                                 8                              8                              8    
logLik                                                       -155323.12                      -66158.93                     -110505.94 
AIC                                                           310666.25                      132337.86                      221031.87 
BIC                                                           310733.52                      132396.43                      221095.67 
deviance                                   2652193786399661247086608      2621580246541362350020080      2640858121694538205440666    
df.residual                                                     6161                           2575                           4351    
nobs                                                            6170                           2584                           4360    
======================================================================================================================================
*** p &lt; 0.001; ** p &lt; 0.01; * p &lt; 0.05</code></pre>
</div>
</div>
</div>
<div id="tabset-17-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-17-3-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a><span class="co"># With this code we construct our formula as a string to use in the model function.</span></span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Check above to see the label of the dependent variable.</span></span>
<span id="cb35-3"><a href="#cb35-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-4"><a href="#cb35-4" aria-hidden="true" tabindex="-1"></a>fml_event_study <span class="ot">&lt;-</span> glue<span class="sc">::</span><span class="fu">glue</span>(<span class="st">'{dependent} ~  anio_fiscal + treatment + i(anio_fiscal,treatment, ref = 2014)'</span>) <span class="sc">%&gt;%</span></span>
<span id="cb35-5"><a href="#cb35-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">formula</span>(.)</span>
<span id="cb35-6"><a href="#cb35-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-7"><a href="#cb35-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Model estimation:</span></span>
<span id="cb35-8"><a href="#cb35-8" aria-hidden="true" tabindex="-1"></a>es_model <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="at">data =</span> rtable,</span>
<span id="cb35-9"><a href="#cb35-9" aria-hidden="true" tabindex="-1"></a>               <span class="at">formula =</span> fml_event_study)</span>
<span id="cb35-10"><a href="#cb35-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-11"><a href="#cb35-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Wald test using clustered matrix of variance/covariance:</span></span>
<span id="cb35-12"><a href="#cb35-12" aria-hidden="true" tabindex="-1"></a>vcov_cl <span class="ot">&lt;-</span> <span class="fu">vcovCL</span>(<span class="at">x =</span> es_model,</span>
<span id="cb35-13"><a href="#cb35-13" aria-hidden="true" tabindex="-1"></a>                  <span class="at">cluster =</span> rtable<span class="sc">$</span>firm_id)</span>
<span id="cb35-14"><a href="#cb35-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-15"><a href="#cb35-15" aria-hidden="true" tabindex="-1"></a><span class="co"># Adjusted standard errors:</span></span>
<span id="cb35-16"><a href="#cb35-16" aria-hidden="true" tabindex="-1"></a>model_corrected <span class="ot">&lt;-</span> <span class="fu">coeftest</span>(<span class="at">vcov. =</span> vcov_cl,</span>
<span id="cb35-17"><a href="#cb35-17" aria-hidden="true" tabindex="-1"></a>                            <span class="at">x =</span> did_model_fe) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
</div>
</section>
<section id="event-study-design-with-fixed-effects-2" class="level2" data-number="3.2">
<h2 data-number="3.2" class="anchored" data-anchor-id="event-study-design-with-fixed-effects-2"><span class="header-section-number">3.2</span> Event Study design (with fixed effects)</h2>
<p><span class="math display">\[Y_{it} = \beta_0 + \beta_1 \times Treatment_{i} + \beta_2 \times Post_{t} + \sum_{k \neq 2014} \beta_k \times Time_{k} \times Treatment_{i} + \alpha_i + \gamma_t + \epsilon_{it}\]</span></p>
<p>Where:</p>
<ul>
<li><span class="math inline">\(\{ k = 2012, \ldots, 2017 \}\)</span></li>
<li><span class="math inline">\(Y_{it}\)</span> is Change from t-1 assets attributable to tax havens (positive), the dependent variable.</li>
<li><span class="math inline">\(Treatment_{i}\)</span> is a dummy variable that is 1 if unit <span class="math inline">\(i\)</span> receives the treatment at time <span class="math inline">\(t\)</span>, and 0 otherwise.</li>
<li><span class="math inline">\(Time_{i}\)</span> are dummy variables that are 1 if the year is <span class="math inline">\(k\)</span>, and 0 otherwise. The year 2014 is the reference year and therefore does not appear in the equation.</li>
<li><span class="math inline">\(alpha_i\)</span> are the fixed effects at firm level</li>
<li><span class="math inline">\(gamma_t\)</span> are the fixed effects at time</li>
<li><span class="math inline">\(\epsilon_{it}\)</span> is the error term.</li>
</ul>
<p><strong>Dependent variable:</strong> Change from t-1 assets attributable to tax havens (positive)</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-18-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-18-1" role="tab" aria-controls="tabset-18-1" aria-selected="true" href="">Plot</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-18-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-18-2" role="tab" aria-controls="tabset-18-2" aria-selected="false" href="">Regression table</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-18-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-18-3" role="tab" aria-controls="tabset-18-3" aria-selected="false" href="">R Code</a></li></ul>
<div class="tab-content">
<div id="tabset-18-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-18-1-tab">
<div class="cell">
<div class="cell-output-display">
<p><img src="regression_transparency_files/figure-html/unnamed-chunk-57-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</div>
<div id="tabset-18-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-18-2-tab">
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>
======================================================================================================================================
                                           All firms                      CIT &gt;= Statutory               CIT &gt; 0                      
--------------------------------------------------------------------------------------------------------------------------------------
anio_fiscal2014                                               -31554.88                     -106179.41                      -58237.98 
                                                              (28814.79)                     (84823.54)                     (43068.42)
anio_fiscal2015                                                45779.59                      -43064.47                      -24995.01 
                                                              (55316.36)                    (179448.45)                    (110134.35)
anio_fiscal2016                                               -15235.67                     -315829.10                     -165606.49 
                                                              (45993.18)                    (197631.90)                    (112324.29)
anio_fiscal2017                                                13040.12                     -222213.30                     -166932.47 
                                                              (56163.47)                    (203922.82)                    (122911.44)
anio_fiscal2018                                                44353.15                      -67470.78                      -93292.58 
                                                              (72445.51)                    (170676.24)                    (147596.65)
anio_fiscal2019                                               530161.59                     1600727.36                      594058.89 
                                                             (551243.22)                   (1811611.98)                    (725936.44)
i(anio_fiscal, treatment, ref = 2014)2013                 2218036681.21                  7513376918.81                  3202137203.09 
                                                         (2781059595.04)                (7616841139.89)                (3447325897.43)
i(anio_fiscal, treatment, ref = 2014)2015                 -787259508.29                    56076724.67                  -352115293.14 
                                                          (628692517.44)                (1144413651.69)                 (727698223.70)
i(anio_fiscal, treatment, ref = 2014)2016                10936241221.32                 19321658891.38                 15825278517.05 
                                                        (10750565253.64)               (20230670365.34)               (15087294767.34)
i(anio_fiscal, treatment, ref = 2014)2017                -5554288836.31                 -8083826123.52                 -6971331130.12 
                                                         (4596536810.26)                (7195473819.30)                (6141211488.12)
i(anio_fiscal, treatment, ref = 2014)2018                -5907715070.22                 -8581018451.08                 -7706805716.88 
                                                         (5124347093.33)                (7905058302.56)                (7091966811.91)
i(anio_fiscal, treatment, ref = 2014)2019                -6064694067.79                -10927375544.45                 -7680526726.28 
                                                         (5302397101.24)               (10136425252.92)                (7128101243.78)
--------------------------------------------------------------------------------------------------------------------------------------
r.squared                                                          0.01                           0.02                           0.02 
adj.r.squared                                                     -0.26                          -0.62                          -0.34 
statistic                                                          4.51                           2.40                           4.12 
p.value                                                            0.00                           0.00                           0.00 
deviance                                   1995246409283257319266268      1967776239021259889862802      1985553981672814507206886    
df.residual                                                     4854                           1570                           3198    
nobs                                                            6170                           2584                           4360    
======================================================================================================================================
*** p &lt; 0.001; ** p &lt; 0.01; * p &lt; 0.05</code></pre>
</div>
</div>
</div>
<div id="tabset-18-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-18-3-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a><span class="co"># With this code we construct our formula as a string to use in the model function.</span></span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Check above to see the label of the dependent variable.</span></span>
<span id="cb37-3"><a href="#cb37-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-4"><a href="#cb37-4" aria-hidden="true" tabindex="-1"></a>fml_event_study <span class="ot">&lt;-</span> glue<span class="sc">::</span><span class="fu">glue</span>(<span class="st">'{dependent} ~  anio_fiscal + treatment + i(anio_fiscal,treatment, ref = 2014)'</span>) <span class="sc">%&gt;%</span></span>
<span id="cb37-5"><a href="#cb37-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">formula</span>(.)</span>
<span id="cb37-6"><a href="#cb37-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-7"><a href="#cb37-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Model estimation:</span></span>
<span id="cb37-8"><a href="#cb37-8" aria-hidden="true" tabindex="-1"></a>es_model_fe <span class="ot">&lt;-</span> <span class="fu">plm</span>(<span class="at">data =</span> rtable,</span>
<span id="cb37-9"><a href="#cb37-9" aria-hidden="true" tabindex="-1"></a>                    <span class="at">formula =</span> fml_event_study,</span>
<span id="cb37-10"><a href="#cb37-10" aria-hidden="true" tabindex="-1"></a>                    <span class="at">index =</span> <span class="fu">c</span>(<span class="st">"firm_id"</span>,<span class="st">"anio_fiscal"</span>),</span>
<span id="cb37-11"><a href="#cb37-11" aria-hidden="true" tabindex="-1"></a>                    <span class="at">model =</span> <span class="st">"within"</span>)</span>
<span id="cb37-12"><a href="#cb37-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-13"><a href="#cb37-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Wald test using clustered matrix of variance/covariance:</span></span>
<span id="cb37-14"><a href="#cb37-14" aria-hidden="true" tabindex="-1"></a>vcov_cl <span class="ot">&lt;-</span> <span class="fu">vcovCL</span>(<span class="at">x =</span> es_model_fe,</span>
<span id="cb37-15"><a href="#cb37-15" aria-hidden="true" tabindex="-1"></a>                  <span class="at">cluster =</span> rtable<span class="sc">$</span>firm_id)</span>
<span id="cb37-16"><a href="#cb37-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-17"><a href="#cb37-17" aria-hidden="true" tabindex="-1"></a><span class="co"># Adjusted standard errors:</span></span>
<span id="cb37-18"><a href="#cb37-18" aria-hidden="true" tabindex="-1"></a>model_corrected <span class="ot">&lt;-</span> <span class="fu">coeftest</span>(<span class="at">vcov. =</span> vcov_cl,</span>
<span id="cb37-19"><a href="#cb37-19" aria-hidden="true" tabindex="-1"></a>                            <span class="at">x =</span> did_model_fe) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
</div>
</section>
<section id="event-study-design-assets-weighted-unsaturated-model-2" class="level2" data-number="3.3">
<h2 data-number="3.3" class="anchored" data-anchor-id="event-study-design-assets-weighted-unsaturated-model-2"><span class="header-section-number">3.3</span> Event Study design assets weighted (unsaturated model)</h2>
<p><span class="math display">\[Y_{it} = \beta_0 + \beta_1 \times Treatment_{i} + \beta_2 \times Post_{t} + \sum_{k \neq 2014} \beta_k \times Time_{k} \times Treatment_{i} + \epsilon_{it}\]</span></p>
<p><span class="math display">\[\text{Note: The model is weighted by: Total assets 2014.}\]</span></p>
<p>Where:</p>
<ul>
<li><span class="math inline">\(\{ k = 2012, \ldots, 2017 \}\)</span></li>
<li><span class="math inline">\(Y_{it}\)</span> is Change from t-1 assets attributable to tax havens (positive), the dependent variable.</li>
<li><span class="math inline">\(Treatment_{i}\)</span> is a dummy variable that is 1 if unit <span class="math inline">\(i\)</span> receives the treatment at time <span class="math inline">\(t\)</span>, and 0 otherwise.</li>
<li><span class="math inline">\(Time_{i}\)</span> are dummy variables that are 1 if the year is <span class="math inline">\(k\)</span>, and 0 otherwise. The year 2014 is the reference year and therefore does not appear in the equation.</li>
<li><span class="math inline">\(\epsilon_{it}\)</span> is the error term.</li>
</ul>
<p><strong>Dependent variable:</strong> Change from t-1 assets attributable to tax havens (positive)</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-19-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-19-1" role="tab" aria-controls="tabset-19-1" aria-selected="true" href="">Plot</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-19-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-19-2" role="tab" aria-controls="tabset-19-2" aria-selected="false" href="">Regression table</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-19-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-19-3" role="tab" aria-controls="tabset-19-3" aria-selected="false" href="">R Code</a></li></ul>
<div class="tab-content">
<div id="tabset-19-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-19-1-tab">
<div class="cell">
<div class="cell-output-display">
<p><img src="regression_transparency_files/figure-html/unnamed-chunk-60-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</div>
<div id="tabset-19-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-19-2-tab">
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>
=================================================================================
                             All firms         CIT &gt;= Statutory  CIT &gt; 0         
---------------------------------------------------------------------------------
(Intercept)                    -116189858.67     -280639969.02     -140387973.94 
                               (102449484.98)    (304618824.52)    (171926785.96)
anio_fiscal                         57729.30         139373.05          69757.69 
                                   (50801.60)       (151243.61)        (85379.34)
treatment                       984295654.45     1293800867.17      684181360.14 
                               (677069373.76)   (1234195002.54)    (651652876.25)
anio_fiscal::2013:treatment    2638909166.66     6974659749.70     3738988351.62 
                              (3048462066.99)   (6856738595.94)   (3684610396.87)
anio_fiscal::2015:treatment    -946172435.19    -1246383356.31     -642229714.01 
                               (677660494.50)   (1235098658.61)    (652207753.01)
anio_fiscal::2016:treatment   16524905575.32    26020067143.27    22707998368.64 
                             (16311125080.28)  (27069313837.86)  (21743159265.89)
anio_fiscal::2017:treatment    -951058422.73    -1246713451.86     -643754357.78 
                               (675679119.57)   (1231290470.02)    (649260817.13)
anio_fiscal::2018:treatment    -745068521.01     -948894856.91     -356987834.90 
                               (721009565.08)   (1282911920.56)    (732440644.39)
anio_fiscal::2019:treatment    -690184803.15     -757169358.05     -289538547.46 
                               (742085815.03)   (1349671602.17)    (766238856.75)
---------------------------------------------------------------------------------
r.squared                               0.01              0.02              0.02 
adj.r.squared                           0.01              0.01              0.01 
sigma                         86448043218.74   132962066548.70   102641503514.72 
logLik                            -155323.92         -66159.17        -110506.44 
AIC                                310665.85         132336.35         221030.87 
BIC                                310726.39         132389.06         221088.30 
nobs                                 6170              2584              4360    
=================================================================================
*** p &lt; 0.001; ** p &lt; 0.01; * p &lt; 0.05</code></pre>
</div>
</div>
</div>
<div id="tabset-19-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-19-3-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a><span class="co"># With this code we construct our formula as a string to use in the model function.</span></span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Check above to see the label of the dependent variable.</span></span>
<span id="cb39-3"><a href="#cb39-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-4"><a href="#cb39-4" aria-hidden="true" tabindex="-1"></a>fml_event_study <span class="ot">&lt;-</span> glue<span class="sc">::</span><span class="fu">glue</span>(<span class="st">'{dependent} ~  anio_fiscal + treatment + i(anio_fiscal,treatment, ref = 2014)'</span>) <span class="sc">%&gt;%</span></span>
<span id="cb39-5"><a href="#cb39-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">formula</span>(.)</span>
<span id="cb39-6"><a href="#cb39-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-7"><a href="#cb39-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Model estimation:</span></span>
<span id="cb39-8"><a href="#cb39-8" aria-hidden="true" tabindex="-1"></a>es_model_aw <span class="ot">&lt;-</span> <span class="fu">feols</span>(<span class="at">data =</span> rtable,</span>
<span id="cb39-9"><a href="#cb39-9" aria-hidden="true" tabindex="-1"></a>                     <span class="at">fml =</span> fml_event_study,</span>
<span id="cb39-10"><a href="#cb39-10" aria-hidden="true" tabindex="-1"></a>                  <span class="at">weights =</span> <span class="sc">~</span>assets_2014,</span>
<span id="cb39-11"><a href="#cb39-11" aria-hidden="true" tabindex="-1"></a>                  <span class="at">cluster =</span> <span class="sc">~</span>firm_id)</span>
<span id="cb39-12"><a href="#cb39-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Wald test using clustered matrix of variance/covariance:</span></span>
<span id="cb39-13"><a href="#cb39-13" aria-hidden="true" tabindex="-1"></a>vcov_cl <span class="ot">&lt;-</span> <span class="fu">vcovCL</span>(<span class="at">x =</span> es_model_aw,</span>
<span id="cb39-14"><a href="#cb39-14" aria-hidden="true" tabindex="-1"></a>                  <span class="at">cluster =</span> rtable<span class="sc">$</span>firm_id)</span>
<span id="cb39-15"><a href="#cb39-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-16"><a href="#cb39-16" aria-hidden="true" tabindex="-1"></a><span class="co"># Adjusted standard errors:</span></span>
<span id="cb39-17"><a href="#cb39-17" aria-hidden="true" tabindex="-1"></a>model_corrected <span class="ot">&lt;-</span> <span class="fu">coeftest</span>(<span class="at">vcov. =</span> vcov_cl,</span>
<span id="cb39-18"><a href="#cb39-18" aria-hidden="true" tabindex="-1"></a>                            <span class="at">x =</span> did_model_fe) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
</div>
</section>
<section id="event-study-design-assets-weighted-with-fixed-effects-2" class="level2" data-number="3.4">
<h2 data-number="3.4" class="anchored" data-anchor-id="event-study-design-assets-weighted-with-fixed-effects-2"><span class="header-section-number">3.4</span> Event Study design assets weighted (with fixed effects)</h2>
<p><span class="math display">\[Y_{it} = \beta_0 + \beta_1 \times Treatment_{i} + \beta_2 \times Post_{t} + \sum_{k \neq 2014} \beta_k \times Time_{k} \times Treatment_{i} + \alpha_i + \gamma_t + \epsilon_{it}\]</span></p>
<p><span class="math display">\[\text{Note: The model is weighted by: Total assets 2014.}\]</span></p>
<p>Where:</p>
<ul>
<li><span class="math inline">\(\{ k = 2012, \ldots, 2017 \}\)</span></li>
<li><span class="math inline">\(Y_{it}\)</span> is Change from t-1 assets attributable to tax havens (positive), the dependent variable.</li>
<li><span class="math inline">\(Treatment_{i}\)</span> is a dummy variable that is 1 if unit <span class="math inline">\(i\)</span> receives the treatment at time <span class="math inline">\(t\)</span>, and 0 otherwise.</li>
<li><span class="math inline">\(Time_{i}\)</span> are dummy variables that are 1 if the year is <span class="math inline">\(k\)</span>, and 0 otherwise. The year 2014 is the reference year and therefore does not appear in the equation.</li>
<li><span class="math inline">\(alpha_i\)</span> are the fixed effects at firm level</li>
<li><span class="math inline">\(gamma_t\)</span> are the fixed effects at time</li>
<li><span class="math inline">\(\epsilon_{it}\)</span> is the error term.</li>
</ul>
<p><strong>Dependent variable:</strong> Change from t-1 assets attributable to tax havens (positive)</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-20-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-20-1" role="tab" aria-controls="tabset-20-1" aria-selected="true" href="">Plot</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-20-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-20-2" role="tab" aria-controls="tabset-20-2" aria-selected="false" href="">Regression table</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-20-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-20-3" role="tab" aria-controls="tabset-20-3" aria-selected="false" href="">R Code</a></li></ul>
<div class="tab-content">
<div id="tabset-20-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-20-1-tab">
<div class="cell">
<div class="cell-output-display">
<p><img src="regression_transparency_files/figure-html/unnamed-chunk-63-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</div>
<div id="tabset-20-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-20-2-tab">
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>
=================================================================================
                             All firms         CIT &gt;= Statutory  CIT &gt; 0         
---------------------------------------------------------------------------------
anio_fiscal::2013:treatment    2594705759.06     8435420652.65     3693206870.61 
                              (3231476619.12)   (8426961250.56)   (3938156042.30)
anio_fiscal::2015:treatment    -928787289.86       82490924.83     -396104098.03 
                               (734484481.62)   (1269108001.17)    (847071160.95)
anio_fiscal::2016:treatment   12609753695.89    21361638297.78    17765192218.00 
                             (12474335002.55)  (22243575344.65)  (17023606455.19)
anio_fiscal::2017:treatment   -6391979941.36    -9091132047.11    -7841042025.81 
                              (5264932553.68)   (8071448457.69)   (6879832797.68)
anio_fiscal::2018:treatment   -6776504336.31    -9510368834.15    -8580261095.89 
                              (5791779792.55)   (8671400166.56)   (7784969247.10)
anio_fiscal::2019:treatment   -6920613746.01   -12061790077.57    -8628530124.88 
                              (5950893673.41)  (11031348936.87)   (7876484592.67)
---------------------------------------------------------------------------------
r.squared                               0.26              0.26              0.26 
adj.r.squared                           0.05             -0.21             -0.01 
sigma                         84469514401.59   147506444341.68   103802551204.74 
logLik                            -154445.86         -65788.57        -109884.69 
AIC                                311523.72         133605.14         222093.39 
BIC                                320377.05         139544.23         229507.21 
nobs                                 6170              2584              4360    
within.r.squared                        0.01              0.02              0.01 
=================================================================================
*** p &lt; 0.001; ** p &lt; 0.01; * p &lt; 0.05</code></pre>
</div>
</div>
</div>
<div id="tabset-20-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-20-3-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a><span class="co"># With this code we construct our formula as a string to use in the model function.</span></span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Check above to see the label of the dependent variable.</span></span>
<span id="cb41-3"><a href="#cb41-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-4"><a href="#cb41-4" aria-hidden="true" tabindex="-1"></a>  fml_event_study_fe <span class="ot">&lt;-</span> glue<span class="sc">::</span><span class="fu">glue</span>(<span class="st">'{dependent} ~  i(anio_fiscal,treatment, ref = 2014) | firm_id + anio_fiscal'</span>) <span class="sc">%&gt;%</span></span>
<span id="cb41-5"><a href="#cb41-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">formula</span>(.)</span>
<span id="cb41-6"><a href="#cb41-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-7"><a href="#cb41-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Model estimation:</span></span>
<span id="cb41-8"><a href="#cb41-8" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb41-9"><a href="#cb41-9" aria-hidden="true" tabindex="-1"></a>es_model_aw_fe <span class="ot">&lt;-</span> <span class="fu">feols</span>(<span class="at">data =</span> rtable,</span>
<span id="cb41-10"><a href="#cb41-10" aria-hidden="true" tabindex="-1"></a>                        <span class="at">fml =</span> fml_event_study_fe,</span>
<span id="cb41-11"><a href="#cb41-11" aria-hidden="true" tabindex="-1"></a>                        <span class="at">weights =</span> <span class="sc">~</span>assets_2014,</span>
<span id="cb41-12"><a href="#cb41-12" aria-hidden="true" tabindex="-1"></a>                        <span class="at">cluster =</span> <span class="sc">~</span>firm_id)</span>
<span id="cb41-13"><a href="#cb41-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-14"><a href="#cb41-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Wald test using clustered matrix of variance/covariance:</span></span>
<span id="cb41-15"><a href="#cb41-15" aria-hidden="true" tabindex="-1"></a>vcov_cl <span class="ot">&lt;-</span> <span class="fu">vcovCL</span>(<span class="at">x =</span> es_model_aw_fe,</span>
<span id="cb41-16"><a href="#cb41-16" aria-hidden="true" tabindex="-1"></a>                  <span class="at">cluster =</span> rtable<span class="sc">$</span>firm_id)</span>
<span id="cb41-17"><a href="#cb41-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-18"><a href="#cb41-18" aria-hidden="true" tabindex="-1"></a><span class="co"># Adjusted standard errors:</span></span>
<span id="cb41-19"><a href="#cb41-19" aria-hidden="true" tabindex="-1"></a>model_corrected <span class="ot">&lt;-</span> <span class="fu">coeftest</span>(<span class="at">vcov. =</span> vcov_cl,</span>
<span id="cb41-20"><a href="#cb41-20" aria-hidden="true" tabindex="-1"></a>                            <span class="at">x =</span> did_model_fe) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
</div>
</section>
<section id="diff-in-diff-design-unsaturated-model-2" class="level2" data-number="3.5">
<h2 data-number="3.5" class="anchored" data-anchor-id="diff-in-diff-design-unsaturated-model-2"><span class="header-section-number">3.5</span> Diff-in-diff design (unsaturated model)</h2>
<p><span class="math display">\[Y_{it} = \beta_0 \times Treatment_{i} + \beta_1 \times Post_{t} + \beta_2 \times Treatment_{i} \times Post_{t} + \epsilon_{it}\]</span></p>
<p>Where:</p>
<ul>
<li><span class="math inline">\(Y_{it}\)</span> is Change from t-1 assets attributable to tax havens (positive), the dependent variable for unit <span class="math inline">\(i\)</span> at time <span class="math inline">\(t\)</span>.</li>
<li><span class="math inline">\(Treatment_{i}\)</span> is a dummy variable that is 1 if unit <span class="math inline">\(i\)</span> receives the treatment at time <span class="math inline">\(t\)</span>, and 0 otherwise.</li>
<li><span class="math inline">\(Post_{t}\)</span> is a dummy variable that is 1 if time <span class="math inline">\(t\)</span> is after the implementation of the treatment, and 0 otherwise.</li>
<li><span class="math inline">\(Treatment_{i} \times Post_{t}\)</span> is the interaction between the treatment and the post period, which captures the treatment effect in the difference-in-differences.</li>
</ul>
<p><strong>Dependent variable:</strong> Change from t-1 assets attributable to tax havens (positive)</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-21-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-21-1" role="tab" aria-controls="tabset-21-1" aria-selected="true" href="">Plot</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-21-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-21-2" role="tab" aria-controls="tabset-21-2" aria-selected="false" href="">Regression table</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-21-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-21-3" role="tab" aria-controls="tabset-21-3" aria-selected="false" href="">R Code</a></li></ul>
<div class="tab-content">
<div id="tabset-21-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-21-1-tab">
<div class="cell">
<div class="cell-output-display">
<p><img src="regression_transparency_files/figure-html/unnamed-chunk-66-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</div>
<div id="tabset-21-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-21-2-tab">
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>
===================================================================================================================
                    All firms                        CIT &gt;= Statutory               CIT &gt; 0                        
-------------------------------------------------------------------------------------------------------------------
(Intercept)                             82264.52 **                      60993.06                      110431.51 **
                                       (30091.72)                       (33796.46)                     (40334.49)  
treatment                          1945727448.24                    4198940460.18                  2180928237.11   
                                  (1735589111.69)                  (4083663749.67)                (2132287954.52)  
postPost                                72387.05                        242677.13                       84101.73   
                                       (73304.83)                      (171742.50)                    (105654.50)  
treatment:postPost                 1455747143.99                     892316398.11                  2360360283.26   
                                  (3510854264.29)                  (6371928823.69)                (4597418924.98)  
-------------------------------------------------------------------------------------------------------------------
r.squared                                   0.00                             0.00                           0.00   
adj.r.squared                               0.00                             0.00                           0.00   
sigma                             20818608302.12                   32070068487.19                 24752965030.60   
statistic                                   4.68                             2.73                           4.27   
p.value                                     0.00                             0.04                           0.01   
df                                          3                                3                              3      
logLik                                -155346.58                        -66174.57                     -110529.01   
AIC                                    310703.16                        132359.14                      221068.02   
BIC                                    310736.79                        132388.42                      221099.92   
deviance            2672433508794638205440428        2653502375354554432642866      2668961614123929167886284      
df.residual                              6166                             2580                           4356      
nobs                                     6170                             2584                           4360      
===================================================================================================================
*** p &lt; 0.001; ** p &lt; 0.01; * p &lt; 0.05</code></pre>
</div>
</div>
</div>
<div id="tabset-21-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-21-3-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a><span class="co"># With this code we construct our formula as a string to use in the model function.</span></span>
<span id="cb43-2"><a href="#cb43-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Check above to see the label of the dependent variable.</span></span>
<span id="cb43-3"><a href="#cb43-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-4"><a href="#cb43-4" aria-hidden="true" tabindex="-1"></a>fml <span class="ot">&lt;-</span> glue<span class="sc">::</span><span class="fu">glue</span>(<span class="st">'dependent_variable ~ treatment + post + treatment:post'</span>)<span class="sc">%&gt;%</span> </span>
<span id="cb43-5"><a href="#cb43-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">formula</span>(.)</span>
<span id="cb43-6"><a href="#cb43-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-7"><a href="#cb43-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Model estimation:</span></span>
<span id="cb43-8"><a href="#cb43-8" aria-hidden="true" tabindex="-1"></a>did_model <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="at">data =</span> rtable,</span>
<span id="cb43-9"><a href="#cb43-9" aria-hidden="true" tabindex="-1"></a>                  <span class="at">formula =</span> fml)</span>
<span id="cb43-10"><a href="#cb43-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-11"><a href="#cb43-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Wald test using clustered matrix of variance/covariance:</span></span>
<span id="cb43-12"><a href="#cb43-12" aria-hidden="true" tabindex="-1"></a>vcov_cl <span class="ot">&lt;-</span> <span class="fu">vcovCL</span>(<span class="at">x =</span> did_model,</span>
<span id="cb43-13"><a href="#cb43-13" aria-hidden="true" tabindex="-1"></a>                  <span class="at">cluster =</span> rtable<span class="sc">$</span>firm_id)</span>
<span id="cb43-14"><a href="#cb43-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-15"><a href="#cb43-15" aria-hidden="true" tabindex="-1"></a><span class="co"># Adjusted standard errors:</span></span>
<span id="cb43-16"><a href="#cb43-16" aria-hidden="true" tabindex="-1"></a>model_corrected <span class="ot">&lt;-</span> <span class="fu">coeftest</span>(<span class="at">vcov. =</span> vcov_cl,</span>
<span id="cb43-17"><a href="#cb43-17" aria-hidden="true" tabindex="-1"></a>                            <span class="at">x =</span> did_model) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
</div>
</section>
<section id="diff-in-diff-design-with-fixed-effects-2" class="level2" data-number="3.6">
<h2 data-number="3.6" class="anchored" data-anchor-id="diff-in-diff-design-with-fixed-effects-2"><span class="header-section-number">3.6</span> Diff-in-diff design (with fixed effects)</h2>
<p><span class="math display">\[Y_{it} = \beta_0 + \beta_1 \times Treatment_{i} + \beta_2 \times Post_{t} + \beta_3 \times Treatment_{i} \times Post_{t} + \alpha_i + \gamma_t + \epsilon_{it}\]</span></p>
<p>Where:</p>
<ul>
<li><span class="math inline">\(Y_{it}\)</span> is Change from t-1 assets attributable to tax havens (positive), the dependent variable for unit <span class="math inline">\(i\)</span> at time <span class="math inline">\(t\)</span>.</li>
<li><span class="math inline">\(Treatment_{i}\)</span> is a dummy variable that is 1 if unit <span class="math inline">\(i\)</span> receives the treatment at time <span class="math inline">\(t\)</span>, and 0 otherwise.</li>
<li><span class="math inline">\(Post_{t}\)</span> is a dummy variable that is 1 if time <span class="math inline">\(t\)</span> is after the implementation of the treatment, and 0 otherwise.</li>
<li><span class="math inline">\(Treatment_{i} \times Post_{t}\)</span> is the interaction between the treatment and the post period, which captures the treatment effect in the difference-in-differences.</li>
<li><span class="math inline">\(\alpha_i\)</span> is the fixed effect for unit <span class="math inline">\(i\)</span>, which captures time-invariant characteristics of each unit.</li>
<li><span class="math inline">\(\gamma_t\)</span> is the fixed effect for time <span class="math inline">\(t\)</span>, which captures any time shock that affects all units in the same way.</li>
<li><span class="math inline">\(\epsilon_{it}\)</span> is the error term.</li>
</ul>
<p><strong>Dependent variable:</strong> Change from t-1 assets attributable to tax havens (positive)</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-22-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-22-1" role="tab" aria-controls="tabset-22-1" aria-selected="true" href="">Plot</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-22-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-22-2" role="tab" aria-controls="tabset-22-2" aria-selected="false" href="">Regression table</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-22-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-22-3" role="tab" aria-controls="tabset-22-3" aria-selected="false" href="">R Code</a></li></ul>
<div class="tab-content">
<div id="tabset-22-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-22-1-tab">
<div class="cell">
<div class="cell-output-display">
<p><img src="regression_transparency_files/figure-html/unnamed-chunk-69-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</div>
<div id="tabset-22-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-22-2-tab">
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>
===============================================================================================================
                    All firms                      CIT &gt;= Statutory               CIT &gt; 0                      
---------------------------------------------------------------------------------------------------------------
postPost                                92425.29                       36945.83                        7359.75 
                                       (75872.03)                     (76213.93)                     (58801.75)
treatment:postPost                -1760674397.11                 -4596172454.18                 -2056386657.78 
                                  (1934833336.60)                (4656559362.40)                (2533243706.38)
---------------------------------------------------------------------------------------------------------------
r.squared                                   0.00                           0.00                           0.00 
adj.r.squared                              -0.27                          -0.63                          -0.36 
statistic                                   0.51                           0.46                           0.35 
p.value                                     0.60                           0.63                           0.71 
deviance            2017083105394030677020068      2002749413231886038244886      2015842900245309907042006    
df.residual                              4864                           1580                           3208    
nobs                                     6170                           2584                           4360    
===============================================================================================================
*** p &lt; 0.001; ** p &lt; 0.01; * p &lt; 0.05</code></pre>
</div>
</div>
</div>
<div id="tabset-22-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-22-3-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a><span class="co"># With this code we construct our formula as a string to use in the model function.</span></span>
<span id="cb45-2"><a href="#cb45-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Check above to see the label of the dependent variable.</span></span>
<span id="cb45-3"><a href="#cb45-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-4"><a href="#cb45-4" aria-hidden="true" tabindex="-1"></a>fml <span class="ot">&lt;-</span> glue<span class="sc">::</span><span class="fu">glue</span>(<span class="st">'dependent_variable ~ treatment + post + treatment:post'</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb45-5"><a href="#cb45-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">formula</span>(.)</span>
<span id="cb45-6"><a href="#cb45-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-7"><a href="#cb45-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Model estimation:</span></span>
<span id="cb45-8"><a href="#cb45-8" aria-hidden="true" tabindex="-1"></a>did_model_fe <span class="ot">&lt;-</span> <span class="fu">plm</span>(<span class="at">data =</span> rtable,</span>
<span id="cb45-9"><a href="#cb45-9" aria-hidden="true" tabindex="-1"></a>                    <span class="at">formula =</span> fml,</span>
<span id="cb45-10"><a href="#cb45-10" aria-hidden="true" tabindex="-1"></a>                    <span class="at">index =</span> <span class="fu">c</span>(<span class="st">"firm_id"</span>,<span class="st">"anio_fiscal"</span>),</span>
<span id="cb45-11"><a href="#cb45-11" aria-hidden="true" tabindex="-1"></a>                    <span class="at">model =</span> <span class="st">"within"</span>)</span>
<span id="cb45-12"><a href="#cb45-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-13"><a href="#cb45-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Wald test using clustered matrix of variance/covariance:</span></span>
<span id="cb45-14"><a href="#cb45-14" aria-hidden="true" tabindex="-1"></a>vcov_cl <span class="ot">&lt;-</span> <span class="fu">vcovCL</span>(<span class="at">x =</span> did_model_fe,</span>
<span id="cb45-15"><a href="#cb45-15" aria-hidden="true" tabindex="-1"></a>                  <span class="at">cluster =</span> rtable<span class="sc">$</span>firm_id)</span>
<span id="cb45-16"><a href="#cb45-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-17"><a href="#cb45-17" aria-hidden="true" tabindex="-1"></a><span class="co"># Adjusted standard errors:</span></span>
<span id="cb45-18"><a href="#cb45-18" aria-hidden="true" tabindex="-1"></a>model_corrected <span class="ot">&lt;-</span> <span class="fu">coeftest</span>(<span class="at">vcov. =</span> vcov_cl,</span>
<span id="cb45-19"><a href="#cb45-19" aria-hidden="true" tabindex="-1"></a>                            <span class="at">x =</span> did_model_fe) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
</div>
</section>
<section id="diff-in-diff-design-assets-weighted-unsaturated-model-2" class="level2" data-number="3.7">
<h2 data-number="3.7" class="anchored" data-anchor-id="diff-in-diff-design-assets-weighted-unsaturated-model-2"><span class="header-section-number">3.7</span> Diff-in-diff design assets weighted (unsaturated model)</h2>
<p><span class="math display">\[Y_{it} = \beta_0 \times Treatment_{i} + \beta_1 \times Post_{t} + \beta_2 \times Treatment_{i} \times Post_{t} + \epsilon_{it}\]</span> <span class="math display">\[\text{Note: The model is weighted by: Total assets 2014.}\]</span></p>
<p>Where:</p>
<ul>
<li><span class="math inline">\(Y_{it}\)</span> is Change from t-1 assets attributable to tax havens (positive), the dependent variable for unit <span class="math inline">\(i\)</span> at time <span class="math inline">\(t\)</span>.</li>
<li><span class="math inline">\(Treatment_{i}\)</span> is a dummy variable that is 1 if unit <span class="math inline">\(i\)</span> receives the treatment at time <span class="math inline">\(t\)</span>, and 0 otherwise.</li>
<li><span class="math inline">\(Post_{t}\)</span> is a dummy variable that is 1 if time <span class="math inline">\(t\)</span> is after the implementation of the treatment, and 0 otherwise.</li>
<li><span class="math inline">\(Treatment_{i} \times Post_{t}\)</span> is the interaction between the treatment and the post period, which captures the treatment effect in the difference-in-differences.</li>
</ul>
<p><strong>Dependent variable:</strong> Change from t-1 assets attributable to tax havens (positive)</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-23-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-23-1" role="tab" aria-controls="tabset-23-1" aria-selected="true" href="">Plot</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-23-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-23-2" role="tab" aria-controls="tabset-23-2" aria-selected="false" href="">Regression table</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-23-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-23-3" role="tab" aria-controls="tabset-23-3" aria-selected="false" href="">R Code</a></li></ul>
<div class="tab-content">
<div id="tabset-23-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-23-1-tab">
<div class="cell">
<div class="cell-output-display">
<p><img src="regression_transparency_files/figure-html/unnamed-chunk-72-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</div>
<div id="tabset-23-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-23-2-tab">
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>
======================================================================================================================
                    All firms                         CIT &gt;= Statutory                CIT &gt; 0                         
----------------------------------------------------------------------------------------------------------------------
(Intercept)                             105443.27 **                       76409.36                       140161.44 **
                                        (38951.52)                        (42818.35)                      (51672.90)  
treatment                           2283641148.29                     4735712631.14                   2512891268.75   
                                   (2033854246.05)                   (4594284601.16)                 (2453586420.93)  
postPost                                 89382.58                         296723.79                       103015.94   
                                        (94122.62)                       (212667.40)                     (133453.88)  
treatment:postPost                  1600451622.81                      911364116.40                   2567297792.96   
                                   (4068468390.94)                   (7136912234.86)                 (5219202175.21)  
----------------------------------------------------------------------------------------------------------------------
r.squared                                    0.00                              0.00                            0.00   
adj.r.squared                                0.00                              0.00                            0.00   
sigma                              86795055528.84                   133728588664.21                 103196383584.31   
statistic                                    5.25                              2.97                            4.68   
p.value                                      0.00                              0.03                            0.00   
df                                           3                                 3                               3      
logLik                                 -156108.47                         -66450.32                      -111030.34   
AIC                                     312226.94                         132910.63                       222070.68   
BIC                                     312260.57                         132939.92                       222102.58   
deviance            46450831341790032972804824        46139005399392285584062402      46389194055736645016444626      
df.residual                               6166                              2580                            4356      
nobs                                      6170                              2584                            4360      
======================================================================================================================
*** p &lt; 0.001; ** p &lt; 0.01; * p &lt; 0.05</code></pre>
</div>
</div>
</div>
<div id="tabset-23-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-23-3-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a><span class="co"># With this code we construct our formula as a string to use in the model function.</span></span>
<span id="cb47-2"><a href="#cb47-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Check above to see the label of the dependent variable.</span></span>
<span id="cb47-3"><a href="#cb47-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-4"><a href="#cb47-4" aria-hidden="true" tabindex="-1"></a>fml <span class="ot">&lt;-</span> glue<span class="sc">::</span><span class="fu">glue</span>(<span class="st">'dependent_variable ~ treatment + post + treatment:post'</span>)<span class="sc">%&gt;%</span> </span>
<span id="cb47-5"><a href="#cb47-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">formula</span>(.)</span>
<span id="cb47-6"><a href="#cb47-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-7"><a href="#cb47-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Model estimation:</span></span>
<span id="cb47-8"><a href="#cb47-8" aria-hidden="true" tabindex="-1"></a>did_model_aw <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="at">data =</span> rtable,</span>
<span id="cb47-9"><a href="#cb47-9" aria-hidden="true" tabindex="-1"></a>                   <span class="at">formula =</span> fml,</span>
<span id="cb47-10"><a href="#cb47-10" aria-hidden="true" tabindex="-1"></a>                   <span class="at">weights =</span> assets_2014)</span>
<span id="cb47-11"><a href="#cb47-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-12"><a href="#cb47-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Wald test using clustered matrix of variance/covariance:</span></span>
<span id="cb47-13"><a href="#cb47-13" aria-hidden="true" tabindex="-1"></a>vcov_cl <span class="ot">&lt;-</span> <span class="fu">vcovCL</span>(<span class="at">x =</span> did_model,</span>
<span id="cb47-14"><a href="#cb47-14" aria-hidden="true" tabindex="-1"></a>                  <span class="at">cluster =</span> rtable<span class="sc">$</span>firm_id)</span>
<span id="cb47-15"><a href="#cb47-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-16"><a href="#cb47-16" aria-hidden="true" tabindex="-1"></a><span class="co"># Adjusted standard errors:</span></span>
<span id="cb47-17"><a href="#cb47-17" aria-hidden="true" tabindex="-1"></a>model_corrected <span class="ot">&lt;-</span> <span class="fu">coeftest</span>(<span class="at">vcov. =</span> vcov_cl,</span>
<span id="cb47-18"><a href="#cb47-18" aria-hidden="true" tabindex="-1"></a>                            <span class="at">x =</span> did_model) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
</div>
</section>
<section id="diff-in-diff-design-assets-weighted-with-fixed-effects-2" class="level2" data-number="3.8">
<h2 data-number="3.8" class="anchored" data-anchor-id="diff-in-diff-design-assets-weighted-with-fixed-effects-2"><span class="header-section-number">3.8</span> Diff-in-diff design assets weighted (with fixed effects)</h2>
<p><span class="math display">\[Y_{it} = \beta_0 + \beta_1 \times Treatment_{i} + \beta_2 \times Post_{t} + \beta_3 \times Treatment_{i} \times Post_{t} + \alpha_i + \gamma_t + \epsilon_{it}\]</span></p>
<p><span class="math display">\[\text{Note: The model is weighted by: Total assets 2014.}\]</span></p>
<p>Where:</p>
<ul>
<li><span class="math inline">\(Y_{it}\)</span> is Change from t-1 assets attributable to tax havens (positive), the dependent variable for unit <span class="math inline">\(i\)</span> at time <span class="math inline">\(t\)</span>.</li>
<li><span class="math inline">\(Treatment_{i}\)</span> is a dummy variable that is 1 if unit <span class="math inline">\(i\)</span> receives the treatment at time <span class="math inline">\(t\)</span>, and 0 otherwise.</li>
<li><span class="math inline">\(Post_{t}\)</span> is a dummy variable that is 1 if time <span class="math inline">\(t\)</span> is after the implementation of the treatment, and 0 otherwise.</li>
<li><span class="math inline">\(Treatment_{i} \times Post_{t}\)</span> is the interaction between the treatment and the post period, which captures the treatment effect in the difference-in-differences.</li>
<li><span class="math inline">\(\alpha_i\)</span> is the fixed effect for unit <span class="math inline">\(i\)</span>, which captures time-invariant characteristics of each unit.</li>
<li><span class="math inline">\(\gamma_t\)</span> is the fixed effect for time <span class="math inline">\(t\)</span>, which captures any time shock that affects all units in the same way.</li>
<li><span class="math inline">\(\epsilon_{it}\)</span> is the error term.</li>
</ul>
<p><strong>Dependent variable:</strong> Change from t-1 assets attributable to tax havens (positive)</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-24-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-24-1" role="tab" aria-controls="tabset-24-1" aria-selected="true" href="">Plot</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-24-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-24-2" role="tab" aria-controls="tabset-24-2" aria-selected="false" href="">Regression table</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-24-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-24-3" role="tab" aria-controls="tabset-24-3" aria-selected="false" href="">R Code</a></li></ul>
<div class="tab-content">
<div id="tabset-24-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-24-1-tab">
<div class="cell">
<div class="cell-output-display">
<p><img src="regression_transparency_files/figure-html/unnamed-chunk-75-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</div>
<div id="tabset-24-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-24-2-tab">
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>
=======================================================================
                    All firms        CIT &gt;= Statutory  CIT &gt; 0         
-----------------------------------------------------------------------
treatment:postPost  -1850616989.34    -4614485414.70    -2080415363.59 
                    (2255604735.35)   (5136564059.62)   (2882021377.97)
-----------------------------------------------------------------------
r.squared                     0.25              0.25              0.25 
adj.r.squared                 0.05             -0.23             -0.02 
sigma               84882175896.68   148394736182.57   104464384296.75 
logLik                  -154474.66         -65806.48        -109912.61 
AIC                      311571.32         133630.96         222139.23 
BIC                      320391.01         139540.77         229521.15 
nobs                       6170              2584              4360    
within.r.squared              0.00              0.00              0.00 
=======================================================================
*** p &lt; 0.001; ** p &lt; 0.01; * p &lt; 0.05</code></pre>
</div>
</div>
</div>
<div id="tabset-24-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-24-3-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb49"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a><span class="co"># With this code we construct our formula as a string to use in the model function.</span></span>
<span id="cb49-2"><a href="#cb49-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Check above to see the label of the dependent variable.</span></span>
<span id="cb49-3"><a href="#cb49-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-4"><a href="#cb49-4" aria-hidden="true" tabindex="-1"></a>fml <span class="ot">&lt;-</span> glue<span class="sc">::</span><span class="fu">glue</span>(<span class="st">'dependent_variable ~ treatment + post + treatment:post'</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb49-5"><a href="#cb49-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">formula</span>(.)</span>
<span id="cb49-6"><a href="#cb49-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-7"><a href="#cb49-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Model estimation:</span></span>
<span id="cb49-8"><a href="#cb49-8" aria-hidden="true" tabindex="-1"></a>did_model_fe_aw <span class="ot">&lt;-</span> <span class="fu">feols</span>(<span class="at">data =</span> rtable,</span>
<span id="cb49-9"><a href="#cb49-9" aria-hidden="true" tabindex="-1"></a>                         <span class="at">fml =</span> fml_fe,</span>
<span id="cb49-10"><a href="#cb49-10" aria-hidden="true" tabindex="-1"></a>                         <span class="at">weights =</span> <span class="sc">~</span>assets_2014,</span>
<span id="cb49-11"><a href="#cb49-11" aria-hidden="true" tabindex="-1"></a>                         <span class="at">cluster =</span> <span class="sc">~</span>firm_id)</span>
<span id="cb49-12"><a href="#cb49-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-13"><a href="#cb49-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Wald test using clustered matrix of variance/covariance:</span></span>
<span id="cb49-14"><a href="#cb49-14" aria-hidden="true" tabindex="-1"></a>vcov_cl <span class="ot">&lt;-</span> <span class="fu">vcovCL</span>(<span class="at">x =</span> did_model_fe,</span>
<span id="cb49-15"><a href="#cb49-15" aria-hidden="true" tabindex="-1"></a>                  <span class="at">cluster =</span> rtable<span class="sc">$</span>firm_id)</span>
<span id="cb49-16"><a href="#cb49-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-17"><a href="#cb49-17" aria-hidden="true" tabindex="-1"></a><span class="co"># Adjusted standard errors:</span></span>
<span id="cb49-18"><a href="#cb49-18" aria-hidden="true" tabindex="-1"></a>model_corrected <span class="ot">&lt;-</span> <span class="fu">coeftest</span>(<span class="at">vcov. =</span> vcov_cl,</span>
<span id="cb49-19"><a href="#cb49-19" aria-hidden="true" tabindex="-1"></a>                            <span class="at">x =</span> did_model_fe) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
</div>
</section>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



</body></html>